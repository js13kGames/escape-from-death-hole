(t=>{var s={};function i(h){if(s[h])return s[h].exports;var e=s[h]={i:h,l:!1,exports:{}};return t[h].call(e.exports,e,e.exports,i),e.l=!0,e.exports}i.m=t,i.c=s,i.d=(t,s,h)=>{i.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:h})},i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"u",{value:!0})},i.t=(t,s)=>{if(1&s&&(t=i(t)),8&s)return t;if(4&s&&"object"==typeof t&&t&&t.u)return t;var h=Object.create(null);if(i.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var e in t)i.d(h,e,(s=>t[s]).bind(null,e));return h},i.n=t=>{var s=t&&t.u?()=>t.default:()=>t;return i.d(s,"a",s),s},i.o=(t,s)=>({}.hasOwnProperty.call(t,s)),i.p="",i(i.s=3)})([t=>{t.exports={}},function(){const t=CanvasRenderingContext2D.prototype;t.mt=function(t,s){this.moveTo(t,s)},t.lt=function(t,s){this.lineTo(t,s)},t.tr=function(t,s){this.translate(t,s)},t.fr=function(t,s,i,h){this.fillRect(t,s,i,h)},t.s=function(){this.save()},t.r=function(){this.restore()},t.bp=function(){this.beginPath()},t.cp=function(){this.closePath()},t.fs=function(t){this.fillStyle=t},t.ss=function(t){this.strokeStyle=t},t.ft=function(t,s,i){this.fillText(t,s,i)},t.st=function(t,s,i,h=20,e="monospace",r="#fff",n="#000"){this.miterLimit=2,this.font=h+"px "+e,this.ss(n),this.lineWidth=4,this.strokeText(t,s,i),this.fs(r),this.ft(t,s,i)},t.ta=function(){this.textAlign="center",this.textBaseline="middle"},t.rot=function(t){this.rotate(t)},t.lw=function(t){this.lineWidth=t},t.rr=function(t,s,i,h,e){return 2*e>i&&(e=i/2),2*e>h&&(e=h/2),this.bp(),this.mt(t+e,s),this.arcTo(t+i,s,t+i,s+h,e),this.arcTo(t+i,s+h,t,s+h,e),this.arcTo(t,s+h,t,s,e),this.arcTo(t,s,t+i,s,e),this.cp(),this.fill(),this}},()=>{},function(t,s,i){i.r(s),i(0),i(1);var h=class{constructor(){this._=[],this.v=new A,this.g=0,this.k=0,this.A=0,this.C=!0,this.D=""+f.floor(9999*p())}S(){for(var t=this.v.M(),s=this.P;s;)(t=A.B(t,s.k)).O(s.v),s=s.P;return t}T(){for(var t=this.k,s=this.P;s;)t+=s.k,s=s.P;return t}H(){for(var t=this.g,s=this.P;s;)t+=s.g,s=s.P;return t}L(t){t.P=this,this._.push(t)}R(t){this.k+=this.A*t;for(var s=this._.length;s--;){var i=this._[s];i.R(t),i.C||this._.splice(s,1)}}F(t){var s=this._.length;if(0!==s){for(t.s(),t.tr(this.v.x,this.v.y-this.g),t.rot(this.k);s--;)this._[s].F(t);t.r()}}K(t){t.s(),t.fs("rgba(0,0,0,0.5"),t.bp(),t.ellipse(0,12+this.g,10,5,0,0,2*w),t.fill(),t.r()}},e=0,r=0;class n{constructor(t){this.time=null==t?void 0:e+t,this.setTime=t}set(t=0){this.time=e+t,this.setTime=t}unset(){this.time=void 0}isSet(){return null!=this.time}active(){return e<=this.time}elapsed(){return e>this.time}get(){return this.isSet()?e-this.time:0}p100(){return this.isSet()?((t,s=1,i=0)=>s-i?((t,s=1,i=0)=>i>t?i:t>s?s:t)((t-i)/(s-i)):0)(this.time-e,0,this.setTime):0}}var a=class extends h{constructor(t=new A){super(),this.V=new A,this.j=new A,this.Z=0,this.I=.98,this.U=10,this.W=100,this.J=-1,this.N=1,this.q=0,this.Y=0,this.G=1/0,this.X=-1,this.$=0,this.tt=0,this.it=!0,this.ht=1,this.v=t}get et(){return this.tt+this.g}L(t){t.P=this,this._.push(t)}rt(){this.C=!1,this.nt&&this.nt.rt(),this.P=void 0}R(t){if(this.C)if(this.$+=t,0>=this.at||this.X&&-1!==this.X&&this.$>=this.X)this.rt();else{var s=this.v.M();this.j.ot(this.N),e<this.Y&&this.j.ct(100),this.V.O(this.j).ot(this.W),this.v.O(this.V),e>this.Y&&(this.V.ct(.5),this.j.ut()),this.Z-=this.I,this.g=f.max(0,this.g+this.Z),1>this.g&&(this.Z=0,this.A=0),this.it&&this.wt(s),this._t(),super.R(t)}}F(t){super.F(t),y&&((t,s)=>{1!=s.dt&&2!=s.dt||(t.s(),t.ss("#fff"),t.bp(),t.mt(s.v.x,s.v.y-s.tt),t.lt(s.v.x+40*s.V.x,s.v.y-s.tt+40*s.V.y),t.stroke(),t.ss("#f0f"),t.bp(),t.mt(s.v.x,s.v.y-s.tt),t.lt(s.v.x,s.v.y-s.tt-2*s.g),t.stroke(),t.ss("#f00"),t.bp(),t.mt(s.v.x,s.v.y-s.tt),t.lt(s.v.x+s.j.x,s.v.y-s.tt+s.j.y),t.stroke(),t.r())})(t,this)}pt(t){return gt.bt.vt&&0!==gt.bt.vt.gt.length&&t.x<S.x&&t.x>=0&&t.y<S.y&&t.y>=0?gt.bt.vt.gt[t.y][t.x]:null}wt(t){var s=d(t),i=d(this.v),h=this.pt(i.M().kt());if(!h||!g(this,h.xt)){var e=s.M(),r=A.At(i,s),n=r.M();n.y=0;var a=this.pt(A.O(s,n).kt());a&&g(this,a.xt)&&e.O(n);var o=r.M();o.x=0,(a=this.pt(A.O(s,o).kt()))&&g(this,a.xt)&&e.O(o),this.v=_(e),this.V.O(r.ct(-1))}}_t(){var t=d(this.S()).kt(),s=this.pt(t);if(s){var i=s.yt-this.tt;0>i&&g(this,s.xt)&&(this.g+=this.tt-s.yt),this.tt=s.yt,this.Et=s,i>0&&(this.g=f.max(0,this.g-i))}}};class o{constructor(){this.Ct=0,this.Dt=0,this.St=[],this.Mt=0,this.Pt=0,this.Ot=0,this.Bt=0,this.Tt=0,this.Ht=0,this.Lt=0,this.Rt=0,this.zt=0,this.Ft=0,this.Kt=0,this.Vt=0,this.jt=[],this.Zt=0,this.It=0,this.Ut=!1,this.Wt=!1,this.Jt=!1,this.Nt=[[o.qt,"#2D2316","#2D2316",o.Yt,o.Gt],[o.qt,"#3D2F1E","#3D2F1E",o.Yt,o.Gt],[o.qt,"#4C3B26","#4C3B26",o.Yt,o.Gt],[o.qt,"#5B462D","#5B462D",o.Yt,o.Gt],[o.qt,"#6B5235","#6B5235",o.Yt,o.Gt],[o.qt,"#7A5E3C","#7A5E3C",o.Yt,o.Gt],[o.qt,"#896A44","#896A44",o.Yt,o.Gt],[o.qt,"#896A44","#896A44",o.Yt,o.Gt],[o.qt,"#896A44","#896A44",o.Yt,o.Gt],[o.qt,"#896A44","#896A44",o.Yt,o.Gt],[o.qt,"#438742","#438742",o.Yt,o.Gt]],this.Qt=[],this.Xt=[[8,8,2,4,4,6,4,6,6,4,0,7,[1],0,0,1,3],[12,12,2,4,7,9,7,9,9,2,0,0,[2,2,2],0,1,0,10],[30,8,5,3,22,2,28,5,10,1,2,2,[8,8,16],2,2,2,20],[30,7,5,3,26,3,26,3,10,1,2,2,[10,10,10],6,5,3,30],[10,30,5,5,3,26,3,26,1,14,2,2,[5,5,5],20,5,4,40],[30,7,25,3,5,3,5,3,15,1,2,2,[5,5,30],6,5,3,50],[30,30,10,10,5,3,5,3,15,10,8,8,[10,15,30],20,5,10,50],[20,20,4,4,16,16,4,16,16,4,10,10,[20,20,40],30,10,10,60],[25,25,3,1,12,4,12,4,20,20,6,3,[10,30,60],10,3,5,60],[25,25,23,23,20,4,12,12,3,20,4,4,[10,10],30,3,5,60],[20,20,5,7,0,0,0,0,0,0,0,0,[0],0,0,0,0]],this.Ct=this.Dt=0,this.Xt.forEach((t,s)=>{this.Qt.push({c:this.Nt[s],$t:new A(t[0],t[1]),ts:new A(t[2],t[3]),hs:new A(t[4],t[5]),es:new A(t[6],t[7]),rs:new A(t[8],t[9]),ns:new A(t[10],t[11]),St:t[12],Mt:t[13],Pt:t[14],Ot:t[15],Bt:t[16],Ht:0,Tt:0,Lt:0,Rt:0,Ut:!1})}),this.as()}get os(){return this.Ct}as(){const t=this.Qt[this.Ct];this.jt=t.c,this.$t=t.$t,this.cs=t.ts,this.hs=t.hs,this.es=t.es,this.rs=t.rs,this.ns=t.ns,this.St=t.St,this.Mt=t.Mt,this.Pt=t.Pt,this.Ot=t.Ot,this.Bt=t.Bt,this.Ut=t.Ut,this.Ht=t.Ht,this.Tt=t.Tt,this.Lt=t.Lt,this.Rt=t.Rt,this.Wt=0==this.Ct,this.Jt=this.Ct==this.Qt.length-1}us(){this.Ct>=0&&this.Ct+1<this.Qt.length&&(this.ls(),this.Dt=this.Ct++)}ws(){this.Ct>0&&this.Ct-1<this.Qt.length&&(this.ls(),this.Dt=this.Ct--)}ls(){const t=this.Qt[this.Ct];t.Ut=this.Ut,t.Ht=this.Ht,t.Tt=this.Tt,t.Lt=this.Lt,t.Rt=this.Rt,t.St=this.St,t.Mt=this.Mt}_s(){this.Ft=0+this.Qt.reduce((t,s)=>t+s.Ht,0),this.zt=0+this.Qt.reduce((t,s)=>t+s.Tt,0),this.Kt=0+this.Qt.reduce((t,s)=>t+s.Lt,0),this.Vt=0+this.Qt.reduce((t,s)=>t+s.Rt,0)}}o.ds="rgba(0,0,0,.5)",o.qt="rgba(0,0,0,0)",o.Yt="rgba(255,0,0,.3)",o.Gt="rgba(0,0,255,.3)";var c=(t,s)=>{if(t==o.qt||t==o.Yt||t==o.Gt)return t;t=t.substr(1);var i=parseInt(t,16),h=f.round(2.55*s),e=(i>>16)+h,r=(i>>8&255)+h,n=(255&i)+h;return"#"+(16777216+65536*(255>e?1>e?0:e:255)+256*(255>r?1>r?0:r:255)+(255>n?1>n?0:n:255)).toString(16).slice(1)},u=class extends a{constructor(t,s,i=0,h,e){super(),this.ps=!1,this.vs=!0,i=f.min(200,f.max(i,0)),this.ms=h,this.xt=e,this.bs=new A(t,s),this.v=_(this.bs),this.yt=this.gs=i}F(t){if(gt.bt.ks(this.v)){var s=~~this.yt;t.drawImage(this.ms,f.floor(this.xt*(D.x+1)),f.floor(D.y*s+s*(s+1)/2-s),f.floor(D.x),f.floor(D.y+s),f.floor(this.v.x-D.x/2),f.floor(this.v.y-s),f.floor(D.x),f.floor(D.y+s)),y&&(t.fs("#000"),t.bp(),t.ta(),t.ft(this.bs.x-1+":"+this.bs.y,this.v.x-D.x/2,this.v.y-2*D.y/3),t.cp(),t.fill())}super.F(t)}},l=(t,s,i,h,e,r=!1)=>{var n=D.x/2,a=D.x/2,o=.5*n+.5*a;t.s(),t.bp(),t.mt(s,i+o),t.lt(s-n,i+o-.5*n),t.lt(s-n,i+o-h-.5*n),t.lt(s,i+o-1*h),t.cp(),t.fs(c(e,-2)),t.ss(c(e,-50)),t.stroke(),t.fill(),t.bp(),t.mt(s,i+o),t.lt(s+a,i+o-.5*a),t.lt(s+a,i+o-h-.5*a),t.lt(s,i+o-1*h),t.cp(),t.fs(c(e,5)),t.ss(c(e,50)),t.stroke(),t.fill(),t.bp(),t.mt(s,i-h),t.lt(s-n,i-h+.5*n),t.lt(s-n+a,i-h+o),t.lt(s+a,i-h+.5*a),t.cp(),t.fs(c(e,-2)),t.ss(c(e,-50)),t.stroke(),t.fill(),r&&(t.fs("#000"),t.bp(),t.ellipse(s,i-h+.5*a,4,2,0,0,2*w),t.cp(),t.fill()),t.r()};const f=Math,w=f.PI;var _=t=>{var s=new A(0,0);return s.x=(t.x-t.y)*D.x/2,s.y=(t.x+t.y)*D.y/2,s},d=t=>{var s=new A;return s.x=t.x/D.x+t.y/D.y,s.y=t.y/D.y-t.x/D.x,s},p=(t=1,s=0)=>f.random()*(s-t)+t,v=()=>2*p()-1,m=(t,s)=>~~(p()*(s-t+1)+t),b=(t,s,i)=>t>=s&&i>=t,g=(t,s)=>null!=s&&(t==gt.bt.xs||0!=s&&t!=gt.bt.xs);class k{constructor(t,s,i,h){this.As=t||0,this.ys=s||0,this.Es=i||0,this.yt=h||0,this.Cs=this.As+this.Es,this.Ds=this.ys+this.yt}set(t,s,i,h){this.As=t,this.ys=s,this.Es=i||this.Es,this.yt=h||this.yt,this.Cs=this.As+this.Es,this.Ds=this.ys+this.yt}get mid(){return new A(this.As+this.Es/2,this.ys+this.yt/2)}}class x{constructor(t=0,s=0){this.x=t,this.y=s}static Ss(){return new x(p(-1,1),p(-1,1))}static O(t,s){return new x(t.x+s.x,t.y+s.y)}static At(t,s){return new x(t.x-s.x,t.y-s.y)}static ct(t,s){return s instanceof x?new x(t.x*s.x,t.y*s.y):new x(t.x*s,t.y*s)}static Ms(t,s){return f.sqrt(f.pow(s.x-t.x,2)+f.pow(s.y-t.y,2))}static Ps(t,s){return void 0===s&&(s=1),new x(s*f.cos(t),s*f.sin(t))}static B(t,s){return new x(t.x*f.cos(s)-t.y*f.sin(s),t.x*f.sin(s)+t.y*f.cos(s))}Os(){return Math.atan2(this.y,this.x)}M(){return new x(this.x,this.y)}Bs(){return f.sqrt(this.x*this.x+this.y*this.y)}Ts(){var t=this.Bs();return t>0?this.ct(1/t):this}ot(t){return this.Bs()>t?(this.Ts(),this.ct(t)):this}O(t){return this.x+=t.x,this.y+=t.y,this}At(t){return this.x-=t.x,this.y-=t.y,this}ct(t){return this.x*=t,this.y*=t,this}kt(){return this.x=f.floor(this.x),this.y=f.floor(this.y),this}ut(){return this.x=0,this.y=0,this}}var A=x;const y=!1;var E=768,C=432;1024>innerWidth||(E=1024,C=576),1536>innerWidth||(E=1536,C=864);var D=new A(60,30),S={x:5,y:5};function M(){for(var t="#",s=0;6>s;s++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}const P={Hs:["#00f"],Ls:["#E3C199","#FCDFBE","#C6936E","#9E6A3E","#5A463B"],Rs:"#db0000"},O={Hs:["#545943","#531F7C"],Ls:["#308949"],Rs:"#262"};var B=class extends a{constructor(t,s){super(t),this.zs=!1,this.Fs=s,this.it=!0}R(t){var s=this.X-this.$;-1!==this.X&&s<.1*this.X&&(this.ht=s/(.1*this.X)),super.R(t)}},T=class extends a{constructor(t,s,i,h,e,r,n,a){super(t),this.g=s,this.Z=i,this.V=h,this.Fs=e,this.Ks=r,this.X=n,this.Vs=a,this._t()}R(t){super.R(t),this.Fs+=1*this.Ks/t}F(t){t.fs("rgba(0,0,0,0.5"),t.fr(this.v.x-this.Fs/4,this.v.y+this.Fs/4-this.tt,this.Fs/2,this.Fs/2),t.fs(this.Vs),t.fr(this.v.x-this.Fs/2,this.v.y-this.Fs/2-this.et,this.Fs,this.Fs),super.F(t)}},H=class extends a{constructor(){super(...arguments),this.js=new A,this.Zs=0,this.Z=0,this.Is=0,this.Us=0,this.Ws=0,this.U=0,this.Js=0,this.Fs=0,this.Ns=0,this.qs=0,this.Ys=0,this.Gs=0,this.Qs=0,this.Vs="#fff",this.Xs=0,this.$s=0,this.ti=-1,this.si=!1,this.ii=[]}R(t){if(0===this.ti)for(;this.ii.length<this.Ws;)this.emit();super.R(t),this.ii=this.ii.filter(t=>t.C);var s=this.Ws/this.Gs;if(this.C&&s>0){var i=1/s;for(this.Xs+=t;this.ii.length<this.Ws&&this.Xs>i;)this.emit(),this.Xs-=i;this.$s+=t,-1!==this.ti&&this.ti<this.$s&&this.rt()}}emit(){var t=this.js.M().ct(v());this.si&&(t=A.B(t,this.T()));var s=this.si?this.S():this.v.M();s.x+=t.x,s.y+=t.y;var i=(this.si?this.T():this.k)+this.Us*v(),h=this.U+this.Js*v(),e=new A(Math.cos(i),Math.sin(i)).ct(h),r=this.Fs+this.Ns*v();r=0>r?0:~~r;var n=this.qs+this.Ys*v();n=0>n?0:~~n;var a=this.Z+this.Is*v();a=0>a?0:~~a;var o=this.Gs+this.Qs*v(),c=(n-r)/o,u=new T(s,this.Zs,a,e,r,c,o,this.Vs);void 0!==this.I&&(u.I=this.I),this.si?(u.g=this.H(),gt.bt.hi(u)):this.L(u),this.ii.push(u)}},L=class extends B{constructor(t,s,i){super(t,s),this.ei=!1,this.Fs=s,null!=i&&(this.Ls=i.Ls,this.ri=i.ri,this.Rs=i.Rs),this.ni=new n,this.ai=new n(1)}R(t){this.j.ct(.9),this.V.ct(.9),this.A*=.9,.005>p()&&this.ni.set(p(.2,.1)),this.ai.elapsed()&&this.ai.set(p(1.5,3)),super.R(t)}oi(){var t=new H;Object.assign(t,{v:new A(0,this.Fs.y/2),k:-Math.PI/4,si:!0,I:.098,Vs:this.Rs,Ws:400,Z:0,Is:2,Fs:2,qs:4,Ys:.5,Gs:1e3,Qs:100,U:0,Js:5,Us:2*Math.PI,ti:300,Zs:this.Fs.y}),this.L(t)}F(t,s={v:new A,r:0}){super.F(t),t.s(),t.globalAlpha=this.ht,t.tr(this.v.x+s.v.x,this.v.y+s.v.y-this.g),this.zs&&this.K(t),t.rot(s.r+this.k),t.ss("#000"),t.bp(),t.fs(this.Ls),t.fr(-this.Fs.x/2,-this.Fs.y,this.Fs.x,this.Fs.y);let i=.5+.5*f.cos(this.ni.p100()*w*2);this.ei&&(i=.2);let h=.3+.3*f.cos(this.ai.p100()*w*2);this.ei&&(h=-.4),t.fs("#000"),t.bp(),t.lw(.1),t.s(),t.tr(3*this.Fs.x/9,-this.Fs.y/8-2),this.ei&&t.rot(w),t.arc(0,0,2,.8+h,w-h),t.cp(),t.fill(),t.r(),t.fs(this.ri),t.bp(),t.fr(-this.Fs.x/2,-this.Fs.y,this.Fs.x,this.Fs.y/4),t.bp(),t.fr(-this.Fs.x/2,-this.Fs.y,this.Fs.x/8,18*this.Fs.y/20),t.ss("#000"),t.fs("#000");const e=this.Fs.y/20;t.bp(),t.ellipse(this.Fs.x/2.25,-this.Fs.y+this.Fs.y/2,.8*e,2.7*e*i,0,0,2*w),t.cp(),t.fill(),t.bp(),t.ellipse(this.Fs.x/4,-this.Fs.y+this.Fs.y/2,1.1*e,3*e*i,0,0,2*w),t.cp(),t.fill(),t.r()}};let R=E/4;const z="rgba(10,10,10,.5)";var F=class extends a{constructor(){super(),this.ci=!1,this.ui=!1,this.li=!1,this.fi=new n(.5),this.wi=new L(new A,new A(32,36),P),this.wi.Ls=P.Ls[Math.random()*P.Ls.length>>0],this.wi.ri=M(),this._i=new L(new A,new A(32,36),O)}R(t){super.R(t),this.fi.elapsed()&&this.fi.set(.5),this.wi.R(t),this._i.R(t)}F(t){t.fs("rgba(100,100,100,.2)"),t.fr(0,0,E,50);const s=gt.bt;s.xs&&(t.fs("#fff"),t.fr(E/2-R/2,10,R,20),t.fs("#d11141"),t.fr(E/2-R/2,10,s.xs.at/s.xs.G*R,20));const i=s.di;t.st("LEVEL "+i.os+"/"+(i.Qt.length-1),20,30,26),t.textAlign="right";let h=E-E/4;if(t.st("💎 "+i.Tt+"/"+s.di.Bt,h+220,35,26),this.ui){t.fs(z),t.rr(E/2-3*E/4/2,40,3*E/4,300,30),t.ta(),t.st("YOU ESCAPED!",E/2-20,100,80+3*f.cos(this.fi.p100()));let s=40,i=120;t.st("Rescued:"+gt.di.Ft,E/2-20,i+1*s,40),t.st("Diamonds:"+gt.di.zt,E/2-20,i+2*s,40),t.st("Zombie killed:"+gt.di.Kt,E/2-20,i+3*s,40),t.st("Human killed:"+gt.di.Vt,E/2-20,i+4*s,40)}if(this.ci&&(t.fs(z),t.rr(40,C/2-C/12,E-80,C/6,30),t.ta(),t.st("Press Enter to try again",E/2-20,C/2,C/12+3*f.cos(this.fi.p100()))),this.li&&(t.fs(z),t.rr(E/2-E/3,2*C/12-80,2*E/3,100,30),t.ta(),t.st(this.pi,E/2,2*C/12-40,30)),s.vi.length>0){let i=E/2-R/2-80,h=36;this.wi.F(t,{v:new A(i,h),r:0}),t.textAlign="left",t.st(":"+s.vi.length,i+20,30,26)}if(s.mi.length>0){let i=E/2+R/2+30,h=36;this._i.F(t,{v:new A(i,h),r:0}),s.di.St.reduce((t,s)=>t+s,0),s.di.St[s.bi-1],s.mi.length;let e="";s.di.St.forEach((t,i)=>{i>s.bi&&(e+=","+t)}),e="",t.textAlign="left",t.st(":"+s.mi.length+" "+e,i+20,30,26)}y&&(t=>{let s=2,i=C/40;if(t.fs("#fff"),t.fr(9,9+1*i,E/2,4*i),gt.bt instanceof vt){let h=gt.bt;if(h.xs){let e="diamonds: "+JSON.stringify(gt.di.Tt),r="maxZombies: "+JSON.stringify(gt.di.St),n="zombieWave: "+JSON.stringify(h.bi);t.st(E+" "+C,10,s++*i,i),t.st(e,10,s++*i,i),t.st(r,10,s++*i,i),t.st(n,10,s++*i,i)}}})(t)}gi(t){this.pi=t,this.li=!0}ki(){this.pi="",this.li=!1}},K=class extends a{constructor(t,s={x:5,y:5}){super(),this.gt=[],this.xi=0,((t=S)=>{S.x=t.x,S.y=t.y})(s);for(var i=S.y;i--;){for(var h=[],e=S.x;e--;){var r;r=new u(e,i,20,t,1),this.L(r),h.push(r)}this.gt.push(h.reverse())}this.gt.reverse()}},V=new class{constructor(){var t=t=>s=>{switch(s.code){case"ArrowRight":case"KeyD":this.Ai=t;break;case"ArrowDown":case"KeyS":this.yi=t;break;case"ArrowLeft":case"KeyA":this.Ei=t;break;case"ArrowUp":case"KeyW":this.Ci=t;break;case"Space":this.Di=t;break;case"NumpadEnter":case"Enter":this.Si=t;break;case"PageUp":this.Mi=t;break;case"PageDown":this.Pi=t}};window.addEventListener("keydown",t(!0)),window.addEventListener("keyup",t(!1));var s=t=>()=>{this.Oi=t};window.addEventListener("mousedown",s(!0)),window.addEventListener("mouseup",s(!1))}};class j{constructor(t,s){this.Ms=80,this.Bi=576,this.Ti=new A,this.Hi=w/4,this.Li=new k(0,0,0,0),this.Ri=new A(.5,.5),this.zi=!0,this.Fi=.15,this.Ki=0,this.Vi(),this.ji=t,this.Zi=s,this.Ii=t/s,this.Ui=!1,this.Wi=100}Ji(t){this.Ki=t}Ni(t){t.s(),this.ct(t),this.qi(t)}Yi(t){t.r()}ct(t){t.scale(this.Ri.x,this.Ri.y)}qi(t){t.tr(-this.Li.As,-this.Li.ys)}R(t){this.Ki=f.max(this.Ki-t,0),this.Gi(this.Ms+.05*(this.Bi-this.Ms))}Vi(){this.Li.set(this.Ti.x-this.Li.Es/2+(this.Ki?6*v():0),this.Ti.y-this.Li.yt/2+(this.Ki?6*v():0),this.Ms*f.tan(this.Hi),this.Li.Es/this.Ii),this.Ri.x=this.ji/this.Li.Es,this.Ri.y=this.Zi/this.Li.yt}Gi(t){this.Ms=t,this.Vi()}Qi(t,s){var i=new A(t,s);this.zi?this.Ti.At(A.At(this.Ti,i).ct(this.Fi)):this.Ti=i.M(),this.Vi()}}class Z extends h{Xi(t){return this._.filter(s=>this.$i(t,s))}$i(t,s){if(t!==s&&t.th.D!==s.th.D)return this.sh(t,s)}sh(t,s){return t.p.x<s.p.x+s.w&&t.p.x+t.w>s.p.x&&t.p.y<s.p.y+s.h&&t.p.y+t.h>s.p.y}}class I extends a{constructor(t,s,i,h,e=-1,r=!1){super(),this.w=i,this.h=h,this.th=t,this.ih=s||new A,this.R(0),this.X=e,r&&gt.bt.hh.L(this)}R(t){super.R(t),this.p=this.th.v.M().O(this.ih).O(new A(0,-this.th.g))}F(t){t.s(),t.lw(1),t.ss("#f00"),t.bp(),t.rect(this.p.x,this.p.y,this.w,this.h),t.stroke(),t.r()}}var U=class{constructor(){this.eh=[]}rh(t){return 0==this.eh.filter(s=>s.n==t).length}nh(t,s=.3){this.eh.push({n:t,t:e+s})}R(t){this.eh=this.eh.filter(t=>e<t.t)}};let W,J,N;J=.3,W=(t=1,s=.05,i=220,h=0,e=0,r=.1,n=0,a=1,o=0,c=0,u=0,l=0,f=0,w=0,_=0,d=0,p=0,v=1,m=0,b=0)=>{let g,k,x=Math,A=44100,y=2*x.PI,E=o*=500*y/A/A,C=i*=(1-s+2*s*x.random(s=[]))*y/A,D=0,S=0,M=0,P=1,O=0,B=0,T=0;for(c*=500*y/A**3,_*=y/A,u*=y/A,l*=A,f=A*f|0,k=(h=A*h+9)+(m*=A)+(e*=A)+(r*=A)+(p*=A)|0;k>M;s[M++]=T)++B%(100*d|0)||(T=n?n>1?n>2?n>3?x.sin((D%y)**3):x.max(x.min(x.tan(D),1),-1):1-(2*D/y%2+2)%2:1-4*x.abs(x.round(D/y)-D/y):x.sin(D),T=(f?1-b+b*x.sin(y*M/f):1)*(T>0?1:-1)*x.abs(T)**a*t*.3*(h>M?M/h:h+m>M?1-(M-h)/m*(1-v):h+m+e>M?v:k-p>M?(k-M-p)/r*v:0),T=p?T/2+(p>M?0:(k-p>M?1:(k-M)/p)*s[M-p|0]/2):T),g=(i+=o+=c)*x.cos(_*S++),D+=g-g*w*(1-1e9*(x.sin(M)+1)%2),P&&++P>l&&(i+=u,C+=u,P=0),!f||++O%f||(i=C,o=E,P=P||1);return(t=N.createBuffer(1,k,A)).getChannelData(0).set(s),(i=N.createBufferSource()).buffer=t,i.connect(N.destination),i.start(),i},N=new(window.AudioContext||webkitAudioContext);const q=()=>$(2,.4,()=>{W(.3,0,65,.08,0,.28,0,0,1.8,0,50,0,0,0,-2,0,0,.2,0,1)}),Y=t=>$(3,.8,()=>{W(.5,.05,90+(t?30:0),.02,.02,.07,4,1,0,0,0,0,0,2,50,0,0,.7,.01,0)}),G=()=>$(7,.4,()=>{W(.4,.2,250,.04,0,.04,0,1,1,0,0,0,0,3,0,0,0,1,0,0)}),Q=()=>W(.03,.5,215,0,.02,.01,2,.1,90.6,0,150,0,0,0,0,0,0,3,.01,.62);let X=new U;function $(t,s=.3,i){X.rh(""+t)&&(i(),X.nh(""+t,s))}class tt extends a{constructor(){super(),this.hh=new Z,this.ah=!1,this.oh=!1,this.uh=!1,this.lh=new j(E,C),this.lh.Ms=5e3,this.lh.Ti=_(new A(5,5))}R(t){this.lh.R(t),V.Ci?this.xs.j.y-=2:V.yi&&(this.xs.j.y+=1),V.Ei?this.xs.j.x-=1:V.Ai&&(this.xs.j.x+=1),(V.Oi||V.Di)&&this.xs.fh()&&(G(),this.xs.wh()),!this.xs._h&&(V.Oi||V.Di)&&this.xs.dh()&&(this.xs.Z+=10,this.xs.j.ct(1.2)),this.hh.R(t),super.R(t)}hi(t){this.L(t)}ph(){}ks(t){return b(t.x,this.lh.Li.As-100,this.lh.Li.Cs+100)&&b(t.y,this.lh.Li.ys-100,this.lh.Li.Ds+100)}}var st=class extends a{constructor(t,s=new A){super(s),this.Fs=new A(16,16),this.vh="",this.mh=!1,this.vh=t,this.it=!0}R(t){this.mh||(this.nt=new I(this,new A(-this.Fs.x/2,0-this.g-this.et),this.Fs.x,this.Fs.y,50,!0)),super.R(t)}bh(t){this.C&&("🔑"!=this.vh||t.gh||(t.gh=!0,this.rt(),t===gt.bt.xs&&gt.kh(3,t,this,.1)),1==t.dt&&"💎"==this.vh&&gt.kh(16,t,this,0,t.D),t===gt.bt.xs&&("🔒"==this.vh&&t.gh&&!gt.di.Ut?(this.mh=!0,gt.di.Ut=!0,gt.kh(4,t,this,.1)):"💗"==this.vh?gt.kh(14,t,this,.1,this.D):this.vh))}F(t,s={v:new A,r:0}){t.s(),t.tr(0,-10),t.tr(this.v.x+s.v.x,this.v.y+s.v.y),this.K(t),t.rot(s.r+this.k),t.fs("rgba(0,0,0,1"),t.bp(),t.ta();let i=this.Fs.x+(this.mh?0:5*f.abs(f.cos(2.5*e)));t.font=i+"px serif",t.ft(this.vh,0,4),t.r()}},it=class extends st{constructor(t=new A,s=new A(10,40)){super("",t),this.xh=100,this.Fs=s,this.Ah=s.y}bh(t){!t._h&&this.C&&1==t.dt&&(t._h=!0,t.yh=t.Eh.Fs=this.Fs,t.Eh.Ah=this.Ah,t.Eh.xh=this.xh,t===gt.bt.xs&&gt.kh(2,t,this,.1),this.rt())}F(t,s={v:new A,r:0}){t.s(),t.tr(0,-10),t.lw(1),t.globalAlpha=this.ht,t.tr(this.v.x+s.v.x,this.v.y+s.v.y),this.K(t),t.rot(s.r+this.k),t.lw(2),t.fs("#d8d8d8"),t.fr(0,-(this.Fs.y-18)/2-8,this.Fs.x/2,this.Ah),t.fs("#cccccc"),t.fr(this.Fs.x/2,-(this.Fs.y-18)/2-8,this.Fs.x/2,this.Ah),t.fs("#963"),t.fr(0,-(this.Fs.y-6)/2-5,this.Fs.x,5),t.fs("#333"),t.fr(this.Fs.x/4,-(this.Fs.y-6)/2-10,this.Fs.x/2,5),t.r()}},ht=class{constructor(t,s,i=!0){this.Ch=0,this.Dh=0,this.Sh=[],this.Mh=t,this.Ph=i,["b","h","s","lL","lR"].forEach(i=>{for(var h=s[i]||[{f:0},{f:t}],e=1;e<h.length;e++)for(var r=h[e-1],n=h[e],a=n.f-r.f,o=0;a>o;o++){var c=o/a,u=this.Sh[r.f+o],l=u||{},f={};if(r.hasOwnProperty("p")){var w=r.p[0]+(n.p[0]-r.p[0])*c,_=r.p[1]+(n.p[1]-r.p[1])*c;f.v=new A(w,_)}else f.v=new A(0,0);if(r.hasOwnProperty("r")){var d=r.r+(n.r-r.r)*c;f.r=d}else f.r=0;l[i]=f,u||this.Sh.push(l)}})}get Oh(){return this.Sh[this.Dh]}get Bh(){return!this.Ph&&this.Dh===this.Mh-1}R(t){this.Ch+=1,this.Dh=f.floor(this.Ch),this.Dh>this.Mh-1&&(this.Dh=0,this.Ch=0)}};let et=-w/180*120;var rt={h:[{f:0,p:[0,.5]},{f:5,p:[0,0]},{f:20,p:[0,.5]}],b:[{f:0,p:[0,0]},{f:15,p:[0,.5]},{f:20,p:[0,0]}],s:[{f:0,r:et},{f:10,r:et-.045},{f:20,r:et}]},nt={h:[{f:0,r:-.1,p:[3,0]},{f:3,r:-.1,p:[3,2]},{f:7,r:-.1,p:[3,0]},{f:13,r:-.1,p:[3,2]},{f:20,r:-.1,p:[3,0]}],b:[{f:0,r:.1,p:[0,0]},{f:3,r:.1,p:[0,2]},{f:7,r:.1,p:[0,0]},{f:13,r:.1,p:[0,2]},{f:20,r:.1,p:[0,0]}],s:[{f:0,r:et-.24,p:[5,0]},{f:10,r:et-.2,p:[3,0]},{f:20,r:et-.24,p:[5,0]}],lL:[{f:0,r:1.4},{f:10,r:-1.4},{f:20,r:1.4}],lR:[{f:0,r:-1.4},{f:10,r:1.4},{f:20,r:-1.4}]},at={h:[{f:0,r:-.1,p:[1,4]},{f:3,r:-.1,p:[1,5]},{f:7,r:-.1,p:[1,4]},{f:13,r:-.1,p:[1,5]},{f:16,r:-.1,p:[1,4]}],b:[{f:0,r:.1},{f:16,r:.1}],s:[{f:0,r:-w-.5,p:[0,-20]},{f:4,r:1.5-w,p:[10,0]},{f:16,r:1.6-w,p:[10,0]}],lL:[{f:0,r:0},{f:8,r:1},{f:16,r:0}],lR:[{f:0,r:0},{f:8,r:-1},{f:16,r:0}]},ot={h:[{f:0,p:[4,-.5]},{f:20,p:[4,0]}],b:[{f:0,p:[0,0]},{f:20,p:[0,0]}]},ct={h:[{f:0,r:0,p:[5,0]},{f:5,r:0,p:[5,-.5]},{f:20,r:0,p:[5,0]}],b:[{f:0,r:0,p:[0,0]},{f:20,r:0,p:[0,0]}],lL:[{f:0,p:[1,0],r:.1},{f:10,p:[-1,0],r:-.1},{f:20,p:[1,0],r:.1}],lR:[{f:0,p:[-1,0],r:-.1},{f:10,p:[1,0],r:.1},{f:20,p:[-1,0],r:-.1}]},ut=class extends B{constructor(t,s){super(t,s),this.Ah=0,this.Th=0,this.Hh=20,this.xh=100,this.Ah=s.y}mh(t){this.Th+=1,this.Ah=this.Fs.y-this.Fs.y/2*(this.Th/this.Hh),this.Th>this.Hh&&(t._h=!1,this.Ah=this.Fs.y,this.Th=0)}R(t){}F(t,s={v:new A,r:0}){super.F(t),t.s(),t.lw(1),t.globalAlpha=this.ht,t.tr(this.v.x+s.v.x,this.v.y+s.v.y-this.et),this.zs&&this.K(t),t.rot(s.r+this.k),t.lw(2),t.fs("#ccf"),t.fr(0,5,this.Fs.x/2,this.Ah),t.fs("#ddf"),t.fr(this.Fs.x/2,5,this.Fs.x/2,this.Ah),t.fs("#963"),t.fr(0,5,this.Fs.x,5),t.fs("#333"),t.fr(this.Fs.x/4,0,this.Fs.x/2,5),t.r()}},lt=class extends B{constructor(t,s,i){super(t,s),this.Lh=new A(12,18),this.Rh=new A(4,12),this.zh=new A(5,4),this.yh=new A(10,40),this.Fh=i,this.Lh=s}R(t){super.R(t)}F(t,s={v:new A,r:0}){super.F(t);var i=this.Fh.Kh.Oh;t.s(),t.lw(1),t.globalAlpha=this.ht,t.tr(this.v.x,this.v.y-this.g),this.zs&&this.K(t),t.rot(s.r+this.k),t.fs(this.Fh.Ls),i.lL&&i.lR&&(t.s(),t.tr(-this.zh.x/2-this.Lh.x/3,-2),t.rot(i.lL.r),t.fr(0,this.zh.y,this.zh.x,this.zh.y/3),t.r(),t.s(),t.tr(-this.zh.x/2+this.Lh.x/3,-2),t.rot(i.lR.r),t.fr(0,this.zh.y,this.zh.x,this.zh.y/3),t.r()),t.s(),t.rot(i.b.r),t.fs(this.Fh.Hs),t.fr(-this.Lh.x/2+i.b.v.x,-this.Lh.y+i.b.v.y,this.Lh.x,this.Lh.y),t.fs(this.Fh.Ls),2==this.Fh.dt?(t.s(),t.tr(0,-this.Lh.y+this.Lh.y/4),t.rot(-w/2),t.fr(-this.Rh.x/2,0,this.Rh.x,1.2*this.Rh.y),t.r()):this.Fh._h||(t.s(),t.tr(0,-this.Lh.y+this.Lh.y/4),t.rot(-20*i.b.r),t.fr(-this.Rh.x/2,0,this.Rh.x,this.Rh.y),t.r()),t.r(),t.r()}};class ft{static goToPosition(t,s=new A){let i=0,h=0,e=A.At(s,t.v);const r=e.Bs();return r>1&&(i=e.Os()-t.Vh,h=1),{m:h,r:i,d:r}}}class wt extends a{constructor(t=new A){super(t),this.Hs=P.Hs[Math.random()*P.Hs.length>>0],this.Rs=P.Rs,this.jh=new A(16,18),this.Zh=new A(1,p(15,20)),this.Lh=new A(12,18),this.zh=new A(4,4),this.Rh=new A(4,12),this.yh=new A(10,40),this.Ih=!1,this.Uh=!1,this.Wh=!1,this.Jh=15,this.Nh=0,this.tt=0,this.gh=!1,this.qh=0,this._h=!1,this.Yh=new n,this.Vh=Math.PI,this.Gh=ft.goToPosition,this.dt=1,this.at=this.G=100,this.W=10,this.q=2,this.Qh=new ht(20,rt),this.Xh=new ht(20,nt),this.$h=new ht(16,at,!1),this.Kh=this.Qh,this.te()}get et(){return this.tt+this.g}te(){this.Ls=P.Ls[Math.random()*P.Ls.length>>0],this.ri=M(),this.se()}ie(t){let s=this.Gh(this,this.he);this.ee(s.r),this.re(s.m*t),2>s.d&&(this.he=null)}ee(t){this.Vh+=t}re(t){this.j.O(A.Ps(this.Vh,t))}dh(){return 0===this.g}fh(){return 0===this.g&&this._h}R(t){this.Nh=f.max(this.Nh-t,0),this.Et&&3==this.Et.xt&&this.ne(this,5,!0),this.V.x>0&&!this.ae&&(this.ae=!0),0>this.V.x&&this.ae&&(this.ae=!1),null==this.he||this.Yh.active()||this.ie(t),this.oe(),this.ce.R(t),this.ue.R(t),this.Eh.R(t),this.le(),this.Kh.R(t),this.Uh=this.Kh==this.$h,this.Uh&&!this.Wh&&(this.Wh=!0,setTimeout(()=>{this.Wh=!1},400)),this._h&&this.V.ct(.5),super.R(t)}rt(){if(this.C){for(this.nt&&(this.nt.C=!1),this.Ih&&this.fe(),this._h&&this.we(new it(this.v.M(),this.yh)),this.gh&&this.we(new st("🔑",this.v.M()));this.qh>0;){let t=new st("💎",this.v.M());this.qh--,gt.bt._e.push(t),this.we(t,2,20)}super.rt()}}we(t,s=m(.5,1.5),i=4){this.de(t,40,s,i),gt.bt.hi(t)}fe(){var t=new L(this.v.M(),this.jh,this);t.ei=!0,t.oi(),t.Ls=this.ce.Ls,t.Rs=this.ce.Rs,t.X=3e3;var s=new lt(this.v.M(),this.Lh,this);s.Rh=this.Rh,s.zh=this.zh,s.X=3e3,s.Y=e+.03,this.de(s,this.g+1,12,20,-.25),t.Y=e+.03,this.de(t,this.g+1,12,20,.25);let i=gt.bt;i.hi(t),i.hi(s)}se(){this.ue=new lt(new A(0,9),this.Lh,this),this.ce=new L(new A(0,this.ue.v.y-this.Lh.y),this.jh,this),this.Eh=new ut(new A(1,this.ue.v.y),this.yh),this.ce.P=this.ue.P=this.Eh.P=this}de(t,s,i,h,e=10){t._t(),t.j.O(A.Ps(p()*w*2).ct(e)),t.g=s,t.Z+=i,t.A=v()/h,t.zs=!0}le(){[this.$h].includes(this.Kh)&&!this.Kh.Bh||(this.V.Bs()>.1?this.Kh=this.Xh:this.Kh=this.Qh)}ne(t,s=1,i=!1){const h=A.At(t.v,this.v).Ts().ct(-100);this.j.O(h),(t.V.Bs()>5||i)&&0==this.Z&&(this.Z+=5)}bh(t){if(this.C&&!this.Wh&&(this.ne(t,1,!1),t==gt.bt.xs&&this._h&&t.V.M().Bs()>.5)){var s=new it(t.v.M(),this.yh);s.Ah=t.Eh.Ah,this.we(s),this._h=!1,this.Yh.set(3)}}oe(){if(!this.C)return;let t=[];t.push({t:1,c:new I(this,new A(-10,-12-this.et+this.g),20,15,50,!0)}),this._h&&this.Uh&&t.push({t:2,c:new I(this,new A(0+(this.ae?0:-1)*(this.Eh.Ah+20),-35-this.et+this.g),this.Eh.Ah+20,40,50,!0)}),t.forEach(t=>{gt.bt.hh.Xi(t.c).forEach(s=>{s.th.bh(this),s.th instanceof wt&&gt.pe(this,s.th,t.t)})})}wh(){gt.kh(5,this,null),this.Kh=this.$h,this.$h.Dh=0;var t=this.ae?1:-1,s=gt.bt.hh.Xi(new I(this,new A(t*(this.Lh.x/2+10+(this.ae?0:36)),-30),36,20));s.length>0&&s.forEach(t=>{0===t.g&&(t.th.bh(this,!1),t.th instanceof wt?gt.kh(6,this,t.th):gt.kh(7,this,t.th))}),this.Nh=this.Jh}F(t){if(gt.bt.ks(A.O(this.v,new A(0,-this.et)))){super.F(t);var s=this.Kh.Oh;t.s(),t.tr(0,-10),t.lw(1),t.tr(this.v.x,this.v.y-this.et),this.Et&&(t.fs("rgba(0,0,0,0.5"),t.bp(),t.ellipse(0,12+this.g,10,5,0,0,2*w),t.fill()),this.ae||t.scale(-1,1),this.ue.F(t,s.b),this.ce.F(t,s.h),this._h&&this.Eh.F(t,s.s),t.ta(),t.font="bold 15px serif",this.gh&&(t.bp(),t.ft("🔑",0,4)),this!=gt.bt.xs&&this.qh>0&&(t.bp(),t.ft("💎",0,4),y&&(this.ae||t.scale(-1,1),t.st(this.qh,0,0,20))),t.r()}}}var _t=class extends a{constructor(t=new A,s=new A(10,40)){super(t),this.Fs=s}F(t){t.s(),t.tr(0,-10),t.lw(1),t.globalAlpha=this.ht,t.tr(this.v.x,this.v.y-this.et),t.rot(this.k),t.lw(2),t.fs("#5B3017"),t.fr(0,-this.Fs.y,this.Fs.x/2,this.Fs.y),t.fs("#875638"),t.fr(this.Fs.x/2,-this.Fs.y,this.Fs.x/2,this.Fs.y),t.r()}};class dt extends wt{constructor(t=new A){super(t),this.dt=2,this.Hs=O.Hs[Math.random()*O.Hs.length>>0],this.Ls=O.Ls[Math.random()*O.Ls.length>>0],this.Rs=this.ce.Rs=O.Rs,this.se(),this.Qh=new ht(20,ot),this.Xh=new ht(20,ct),this.W=.8}}var pt=class extends a{constructor(t,s,i){super(t),this.Fs=s,this.ve=i,this.X=250}R(t){super.R(t),this.Z+=2}F(t){t.s(),t.tr(this.v.x,this.v.y),t.bp(),t.st(this.ve,0-this.Fs.x/2,0+this.Fs.y/2-this.g,12,"Helvetica"),t.r()}},vt=class extends tt{constructor(t,s=new o,i=new wt){super(),this.vi=[],this.mi=[],this.me=[],this._e=[],this.be=new n(1),this.ge=new n,this.ke=!0,this.xe=!1,this.bi=0,this.Ae=32,this.ye=[],this.Ee=[],this.Ce=[],this.De=[],this.Se=!1,this.Me=()=>new Promise((t,s)=>{this.vt=new K(this.ms,{x:this.di.$t.x,y:this.di.$t.y}),null!=this.vt?t("OK"):s(Error("It broke"))}),this.ms=t,this.di=s,this.xs=i,this.xs.v=new A,this.Pe=new F,this.Oe=new a,this.Me(this).then(()=>{this.as()})}as(){if(this.L(this.Oe),this.L(this.vt),6==this.di.Ct)for(let t=0;t<S.x;t++)for(let s=0;s<S.y;s++)if(0==s||s==S.y-1||0==t||t==S.x-1){let i=this.vt.pt(new A(t,s).kt());i.xt=3,i.yt=18,i.ps=!0}const t=new A(this.di.cs.x,this.di.cs.y);let s,i,h,e;if(!this.di.Jt){if(s=this.di.hs,this.Be=this.vt.pt(s),this.Be.xt=2,this.Be.yt=30,this.Be.ps=!0,i=this.di.es,this.Te=this.vt.pt(i),this.Te.yt=30,this.Te.ps=!0,!this.di.Ut){let t=new st("🔒",this.Te.v);t.v=this.Te.v.M().O(new A(0,-15)),t.g=50,this.Oe.L(t)}if(h=this.di.rs,this.He=this.vt.pt(h),this.He.yt=30,this.He.ps=!0,!this.di.Ut){let t=new st("🔑",this.He.v);t.v=this.He.v.M().O(new A(0,-15)),t.g=50,this.Oe.L(t)}}this.Le=this.vt.pt(t),this.di.Wt||(this.di.Jt||(this.Le.yt=-500),this.Le.ps=!0,this.Le.xt=0,this.Le&&(this.Re=new u(this.Le.bs.x-1.4,this.Le.bs.y-1.3,this.Le.yt,this.Le.ms,1),this.Re.yt=3,this.Oe.L(this.Re))),e=this.di.Dt>this.di.Ct?_(new A(s.x+2.5,s.y+.5)):_(t.O(new A(1.5,-.5))),this.xs.v=e,this.xs._h=this.di.ze,this.di.Jt&&(this.xs._h=!1),this.xs.Fe=!1,(this.di.Ct<this.di.Dt||this.di.Wt)&&(this.xs.g=1500),this.Oe.L(this.xs);let r=0,n=0;for(;r++<this.di.Ot;){let t=p()>.8,s=t?new it(new A,new A(12,50)):new it;if(s.v=_(this.di.ns).O(new A(t?4:0,0)),s.g=30,s.j.O(A.Ss().ct(10)),s.k=p(-1,1)*w/4,this.me.push(s),this.Oe.L(s),++n>1e3)break}for(this.Ke(this.me,"💗",this.di.Pt),this.Ke(this._e,"💎",this.di.Bt-this.di.Tt);this.vi.length<this.di.Mt;){let t=0;var a=mt();if(A.Ms(a,this.xs.v)>this.di.$t.x*D.x/4){let t=new wt(a);t.g=20,t.V.O(new A(p(-1,1),p(-1,1)).ct(p(.1,.5))),this.vi.push(t),this.Oe.L(t)}if(++t>1e3)break}this.Ve=null,this.di.Jt}Ke(t,s="",i=0){let h=0,e=0;if(this.xs)for(;i>e;){let i=mt(),r=t.filter(t=>50>A.Ms(i,t.v)).length>0,n=0==this.me.filter(t=>50>A.Ms(i,t.v)).length,a=!this.Le||A.Ms(i,this.Le.v)>50,o=!this.He||A.Ms(i,this.He.v)>50,c=!this.Be||A.Ms(i,this.Be.v)>50;if(!r&&n&&a&&c&&o){let h=new st(s,i);t.push(h),this.Oe.L(h),e++}if(++h>1e3)break}}hi(t){this.Oe.L(t)}je(t,s){this.Oe.L(new pt(t.M(),new A(4,4),s))}R(t){if(!this.di.Jt&&this.xe&&V.Si&&(this.ah=!0),this.Pe.R(t),null!=this.xs){if(0==this.xs.at){if(!this.xe){let t=new dt(this.xs.v.M());t.ri=this.xs.ri,t.se(),t.g=20,t.V.O(A.Ss().ct(p(.1,.5))),this.mi.push(t),this.Oe.L(t),this.xs=t,this.xe=!0}this.Pe.ci=!0}if(40>this.xs.at&&!this.xe&&gt.kh(12,this.xs,null),this.di.Wt||this.xs.Et!=this.Le||!this.Ze(this.xs)||this.oh||(this.Ie(),this.oh=!0),0==this.xs.g&&this.di.St.length>=1&&this.di.St[this.bi]>0&&0==this.mi.length){let t=0;for(;this.mi.length<this.di.St[this.bi];){var s=mt();if(A.Ms(s,this.xs.v)>200){let t=new dt(s);t.g=20,this.mi.push(t),this.Oe.L(t)}if(++t>1e3)break}this.bi>0&&this.di.St.length>1?(this.Pe.gi("Wave "+(this.bi+1)+" of "+this.di.St.length),setTimeout(()=>{this.Pe.ki(),this.bi+=1},3e3)):this.bi+=1}if(this.di.Jt&&this.bi>=this.di.St.length-1&&0==this.mi.length&&(this.Pe.ui=!0,this.Le&&(this.Re.v.x<this.Le.v.x-15&&(this.Re.v.x+=.1),this.Re.v.y<this.Le.v.y-20&&(this.Re.v.y+=.1)),setTimeout(()=>{this.Se=!0},2e3),this.Se&&this.Ue()),this.di.Ut){if(this.xs.gh=!1,!this.Ve&&this.Be){let t=new u(this.Be.bs.x-.65,this.Be.bs.y-.65,this.Be.yt-20,this.Be.ms,2);this.Oe.L(t),this.Be.xt=0,this.Ve=new _t(this.Be.v.M(),new A(3,200)),this.Ve.g=200,gt.bt.hi(this.Ve),this.ge.set(.5)}this.xs.Et&&this.Be&&30>A.Ms(this.xs.Et.v,this.Be.v)&&(this.xs.v=this.Be.v.M().O(new A(-3,D.y/2-10)),this.xs.V.ut()),(this.Ze(this.xs)&&this.xs.Et&&this.xs.Et===this.Be&&this.ge.elapsed()&&!this.xs.Fe||this.xs.Fe)&&(this.xs.Fe=!0,$(9,3,()=>{W(.2,.05,329.6276,.01,.29,1,0,1.6,1.2,0,-25,.15,20,0,0,0,0,.71,.18,.2)}),this.Be.yt+=1.5),this.xs.Et&&this.xs.Et.yt>120&&(gt.We(this.vi.length),this.Ie(),this.ah=!0)}this.mi=this.mi.filter(t=>t.C),this.vi=this.vi.filter(t=>t.C),this.me=this.me.filter(t=>t.C),this._e=this._e.filter(t=>t.C),this.vi.forEach(t=>{if(null==t.he){let s=mt();A.Ms(s,t.v)>20&&(t.he=s)}}),this.mi.sort(()=>p()-.5).some(t=>{t.he=null;let s=this.vi.filter(s=>100>A.Ms(t.v,s.v)).sort(s=>A.Ms(s.v,t.v));s.length>0?t.he=s[0].v.M():this.xs.C&&this.Ze(this.xs)&&(t.he=this.xs.v.M())}),this.me.forEach(t=>{null!=t.Je&&(t.v,t.Je.v)}),this.Oe._=this.Oe._.sort((t,s)=>s.v.y-t.v.y),super.R(t)}}Ne(t){return 2==t.dt}Ze(t){return 1==t.dt}qe(t){return t==gt.bt.xs}Ie(){this.di.St=[this.mi.length],this.di.Mt=this.vi.length,this.di.Bt=this.me.filter(t=>t instanceof st&&"💎"==t.vh).length}pe(t,s,i){t==this.xs&&2==i&&this.Ne(s)?gt.kh(8,t,s,.3,s.D):2==i&&t==this.xs&&this.Ze(s)?gt.kh(9,t,s):this.Ne(t)&&this.Ze(s)&&s!=this.xs?gt.kh(11,t,s):this.Ne(t)&&s===this.xs&&(this.xs.Wh||gt.kh(10,t,s,.4))}Ye(t,s,i){let h=gt.bt.xs;switch(t){case 14:h.at<h.G&&(W(1.02,.05,288,.02,.07,.15,2,.87,-4.6,0,-317,.04,0,0,0,0,0,.71,.03,0),h.at=h.G,this.je(h.v,i.vh),i.rt());break;case 12:q();break;case 10:gt.bt.lh.Ji(20),q(),i.at=f.max(0,i.at-10),i.at>0||gt.bt.lh.Ji(100),this.Ye(15,s,i);break;case 15:break;case 11:i.C&&(i.at=f.max(0,i.at-25));break;case 5:h.Eh.mh(h);break;case 9:case 8:i.at=f.max(0,i.at-h.Eh.xh),i.C&&0>=i.at?($(30,.8,()=>{W(.5,.05,120,.03,.12,.07,4,1,1,1.1,150,0,.01,2,45,0,0,.2,.04,0)}),i.Ih=!0,2==i.dt&&gt.Ge(1),1==i.dt&&gt.Qe(1)):Y();break;case 16:i.C&&(s==gt.xs?gt.Xe(1):s.qh++,Q(),i.rt());break;case 2:W(.4,.2,150,.05,0,.05,0,1,-1,0,0,0,0,4,0,0,0,1,.02,0);break;case 3:W(.2,0,300,.1,.3,.1,0,1.61,0,0,286,.06,.18,0,0,0,0,.4,.1,.09),this.je(i.v,i.vh);break;case 4:W(.2,0,850,.1,.3,.1,0,1.61,0,0,286,.06,.18,0,0,0,0,.4,.1,.09),i.vh="🔓",this.je(i.v,i.vh);break;case 5:G();break;case 6:Y(),i.at=f.max(0,i.at-25);break;case 7:Y()}}F(t){if(this.ke&&(t.globalCompositeOperation="source-over"),this.xs&&this.lh.Qi(this.xs.v.x,this.xs.v.y+this.xs.g-this.xs.et),this.lh.Ni(t),super.F(t),this.xs){let s=this.xs.v.M().O(new A(0,-this.xs.et+this.xs.g));if(t.lw(4),this.mi.forEach(i=>{let h=new A(i.v.x,i.v.y-i.et),e=A.At(h,s);t.bp(),t.ss("rgba(10,255,10,.2)"),t.ellipse(s.x,s.y,30,15,0,e.Os()-.2,e.Os()+.2),t.stroke()}),this.Be&&this.Te&&!this.xs.Fe&&(this.Te&&this.xs.gh||this.di.Ut)){let i=this.di.Ut?this.Be.S():this.Te.S(),h=A.At(i,s);t.bp(),t.lw(2),t.ss("rgba(255,255,255,.2)"),t.s(),t.tr(s.x,s.y),t.rot(h.Os()),t.setLineDash([10,20]),t.mt(30,0),t.lt(0,0),t.mt(30,0),t.lt(25,3),t.mt(30,0),t.lt(25,-3),t.stroke(),t.r()}}if(y&&this.hh.F(t),this.lh.Yi(t),this.ke&&!this.di.Jt){let o=f.abs(f.cos(e/10+10*p()));this.Ae>3?this.Ae*=.98:o=1;var s=E,i=C,h=gt.$e.cloneNode().getContext("2d"),r=h.createRadialGradient(s/2,i/2,s/this.Ae+s/this.Ae*o,s/2,i/2,0);r.addColorStop(0,"transparent"),r.addColorStop(1,"white"),h.fillStyle=r,h.filter="blur(5px)",h.fr(0,0,s,i);var n=E/2,a=C/2;t.globalCompositeOperation="destination-in",t.drawImage(h.canvas,n-s/2,a-i/2),t.globalCompositeOperation="lighten",t.fr(0,0,s,i),t.globalCompositeOperation="source-over"}this.Pe.F(t)}Ue(){this.di.ls(),this.di._s(),this.ye.length<this.di.Ft?this.sr(this.ye,new A(0,-50),P):this.De.length<this.di.zt?this.ir(new A(0,120)):this.Ce.length<this.di.Kt?this.hr(this.Ce,new A(-150,120),O):this.Ee.length<this.di.Vt&&this.hr(this.Ee,new A(150,120),P)}sr(t,s,i){var h=new wt(this.xs.v.M().O(s));h.X=-1,h._t(),h.V.O(A.Ps(p()*w*2).ct(40*p())),h.g=20,h.Z+=3,h.A=v()/2,gt.bt.hi(h),this.ye.push(h)}ir(t,s){var i=new st("💎",this.xs.v.M().O(t));i.mh=!0,i.X=-1,i._t(),i.V.O(A.Ps(p()*w*2).ct(40*p())),i.g=20,i.Z+=3,i.A=v()/2,gt.bt.hi(i),this.De.push(i)}hr(t,s,i){var h=new L(this.xs.v.M().O(s),new A(16,18),this);h.ei=!0,h.Ls=i.Ls[Math.random()*i.Ls.length>>0],h.Rs=i.Rs,h.oi(),h.X=-1,h.Y=e+.03,h._t(),h.V.O(A.Ps(p()*w*2).ct(40*p())),h.g=20,h.Z+=3,h.A=v()/2,h.zs=!0,gt.bt.hi(h),t.push(h)}};function mt(){return _(new A(m(0,S.x-1),m(0,S.y-1)))}var bt=class extends tt{constructor(t){super(),this.er=!1,this.nr=-.098,this.xs=t,this.Pe=new F,this.Pe.F=t=>{t.fs("#111"),t.rr(9,9,E-18,C/3,20),t.ta(),t.st("Escape from",E/2-9,C/8-C/18,E/20,"Helvetica","#ED1B23","#fff"),t.st("DEATH HOLE",E/2-9,C/8+C/10,E/8,"Helvetica","#ED1B23","#fff"),t.fs("#896A44"),t.fr(0,C-C/4,E/2-100,C/3),t.fr(E/2+100,C-C/4,E/2-100,C/3),t.fs("#438742"),t.fr(0,C-C/4,E/2-100,50),t.fr(E/2+100,C-C/4,E/2-100,50),this.er||(t.fs("#444"),t.fr(E/2-100,C-C/4,200,25));let s=1*C/30;t.st("Use arrow keys or WASD to move",E/2,C/2-4*s,20),t.st("Click or Space to action",E/2,C/2-3*s,20),t.st("Press Enter to start",E/2,C/2+C/2.5,40+3*f.cos(this.Pe.fi.p100()))},this.lh.Ti=new A(24,-22),this.lh.Bi=this.lh.Ms=400,this.xs.v=new A(-100,30),this.L(this.xs)}R(t){super.R(t),this.Pe.R(t),this.xs.j=new A(30,0),this.lh.Li.mid.x>this.xs.v.x?this.lh.Ti=new A(24-100*e,-22):this.xs.j.ut(),V.Di&&this.xs.dh()&&this.ar(),V.Si&&!this.er&&(this.er=!0,setTimeout(()=>{this.ah=!0},2500)),this.er&&(this.nr*=1.1,this.xs.v.y-=this.nr)}F(t){this.lh.Ni(t),super.F(t),y&&this.hh.F(t),this.lh.Yi(t),this.Pe.F(t)}ph(){this.ar()}ar(){Q(),this.xs.te(),gt.or.ri=this.xs.ri,gt.or.Ls=this.xs.Ls}},gt=new class{constructor(){this.di=new o,this.cr=!1,this.ur=[],this.lr=new U,this.wr=[],this._r=t=>new Promise((s,i)=>{t.di.Qt.forEach(s=>{const i=(t=>{var s=document.createElement("canvas"),i=s.getContext("2d");i.imageSmoothingEnabled=!0,s.width=(D.x+1)*t.length,s.height=60*D.y+1830;for(var h=0;h<t.length;h++)for(var e=t[h],r=h*(D.x+1)+(D.x+1)/2,n=0;60>n;n++){var a=n,o=D.y*n+n*(n+1)/2;l(i,r,o,a,e,2==h)}return s})(s.c);t.ur.push(i)}),t.ur.length>0?s("OK"):i(Error("It broke"))}),this.Ch=performance.now(),this.$e=document.getElementById("game"),this.dr=this.$e.getContext("2d"),this.$e.width=E,this.$e.height=C,oncontextmenu=()=>!1,onscroll=t=>t.preventDefault(),this._r(this).then(()=>{this.pr()}),setInterval(()=>W(.1,5,25,.29,.08,1,0,.6,0,0,0,0,.1,0,0,0,0,.7,1,0),500),this.or=new wt(new A(0,0)),this.or.Hs="#f00",this.or.se(),this.xs=new wt(new A(0,0)),this.xs.Hs="#f00",this.xs.se(),onmouseup=()=>{this.bt.ph()},document.monetization&&document.monetization.addEventListener("monetizationstart",()=>{document.getElementById("exclusive").classList.remove("hidden")})}We(t){this.di.Ht+=t}Xe(t){this.di.Tt+=t}Ge(t){this.di.Lt+=t}Qe(t){this.di.Rt+=t}kh(t,s,i,h=.3,e=""){(0==h||this.lr.rh(t+e))&&(this.bt instanceof vt&&this.bt.Ye(t,s,i),0!=h&&this.lr.nh(t+e,h))}pe(t,s,i){t.C&&s.C&&this.bt instanceof vt&&this.bt.pe(t,s,i)}pr(){this.vr(),this.bt=new bt(this.xs),this.mr()}mr(){this.br=requestAnimationFrame(this.gr.bind(this))}vr(){cancelAnimationFrame(this.br)}gr(t){this.br=requestAnimationFrame(this.gr.bind(this));var s=f.max(0,t-this.Ch);this.R(s),this.Ch=t,e=(r+=1)/60}Yi(){this.vr(),this.kr(),this.mr()}kr(){this.vr(),this.di.ze=this.bt.xs._h,this.di.us(),this.xr(),this.mr()}Ar(){this.vr(),this.di.ze=this.bt.xs._h,this.di.ws(),this.xr(),this.mr()}xr(){this.di.as(),this.bt=new vt(this.ur[this.di.Ct],this.di,this.xs),this.bt.oh=!1,this.bt.xe=!1}R(t){this.bt.R(t),(t=>{X.R(t)})(t),this.lr.R(t),this.bt.ah&&(this.bt.ah=!1,this.bt instanceof bt?this.xr():this.bt instanceof vt&&(this.bt.xe?(this.vr(),this.xs=new wt,this.xs.Hs="#f00",this.xs.ri=this.or.ri,this.xs.Ls=this.or.Ls,this.xs.se(),this.xr(),this.mr()):this.kr())),this.bt.oh&&(this.Ar(),this.bt.oh=!1),this.F()}F(){var{dr:t,bt:s}=this;t.clearRect(0,0,E,C),t.fs("rgba(0,0,0,1)"),t.fr(0,0,E,C),t.s(),s.F(t),t.r()}};i(2)}]);