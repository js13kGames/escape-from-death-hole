(t=>{var s={};function i(h){if(s[h])return s[h].exports;var e=s[h]={i:h,l:!1,exports:{}};return t[h].call(e.exports,e,e.exports,i),e.l=!0,e.exports}i.m=t,i.c=s,i.d=(t,s,h)=>{i.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:h})},i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"u",{value:!0})},i.t=(t,s)=>{if(1&s&&(t=i(t)),8&s)return t;if(4&s&&"object"==typeof t&&t&&t.u)return t;var h=Object.create(null);if(i.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var e in t)i.d(h,e,(s=>t[s]).bind(null,e));return h},i.n=t=>{var s=t&&t.u?()=>t.default:()=>t;return i.d(s,"a",s),s},i.o=(t,s)=>({}.hasOwnProperty.call(t,s)),i.p="",i(i.s=3)})([t=>{t.exports={}},function(){const t=CanvasRenderingContext2D.prototype;t.mt=function(t,s){this.moveTo(t,s)},t.lt=function(t,s){this.lineTo(t,s)},t.tr=function(t,s){this.translate(t,s)},t.fr=function(t,s,i,h){this.fillRect(t,s,i,h)},t.s=function(){this.save()},t.r=function(){this.restore()},t.bp=function(){this.beginPath()},t.cp=function(){this.closePath()},t.fs=function(t){this.fillStyle=t},t.ss=function(t){this.strokeStyle=t},t.ft=function(t,s,i){this.fillText(t,s,i)},t.st=function(t,s,i,h=20,e="monospace",r="#fff",n="#000"){this.miterLimit=2,this.font=h+"px "+e,this.ss(n),this.lw(4),this.strokeText(t,s,i),this.fs(r),this.ft(t,s,i)},t.ta=function(t="center"){this.textAlign=t,this.textBaseline="middle"},t.rot=function(t){this.rotate(t)},t.lw=function(t){this.lineWidth=t},t.rr=function(t,s,i,h,e){return 2*e>i&&(e=i/2),2*e>h&&(e=h/2),this.bp(),this.mt(t+e,s),this.arcTo(t+i,s,t+i,s+h,e),this.arcTo(t+i,s+h,t,s+h,e),this.arcTo(t,s+h,t,s,e),this.arcTo(t,s,t+i,s,e),this.cp(),this.fill(),this}},()=>{},function(t,s,i){i.r(s),i(0),i(1);class h{constructor(t=0,s=0){this.x=t,this.y=s}static _(){return new h(m(-1,1),m(-1,1))}static v(t,s){return new h(t.x+s.x,t.y+s.y)}static g(t,s){return new h(t.x-s.x,t.y-s.y)}static k(t,s){return s instanceof h?new h(t.x*s.x,t.y*s.y):new h(t.x*s,t.y*s)}static C(t,s){return _.sqrt(_.pow(s.x-t.x,2)+_.pow(s.y-t.y,2))}static A(t,s){return void 0===s&&(s=1),new h(s*_.cos(t),s*_.sin(t))}static S(t,s){return new h(t.x*_.cos(s)-t.y*_.sin(s),t.x*_.sin(s)+t.y*_.cos(s))}P(){return Math.atan2(this.y,this.x)}D(){return new h(this.x,this.y)}T(){return _.sqrt(this.x*this.x+this.y*this.y)}O(){var t=this.T();return t>0?this.k(1/t):this}H(t){return this.T()>t?(this.O(),this.k(t)):this}v(t){return this.x+=t.x,this.y+=t.y,this}g(t){return this.x-=t.x,this.y-=t.y,this}k(t){return this.x*=t,this.y*=t,this}L(){return this.x=_.floor(this.x),this.y=_.floor(this.y),this}R(){return this.x=0,this.y=0,this}}var e=h,r=class{constructor(){this.M=[],this.B=new e,this.K=0,this.V=0,this.j=0,this.F=!0,this.Z=""+_.floor(9999*m()),this.U=1}W(){for(var t=this.B.D(),s=this.I;s;)(t=e.S(t,s.V)).v(s.B),s=s.I;return t}q(){for(var t=this.V,s=this.I;s;)t+=s.V,s=s.I;return t}Y(){for(var t=this.K,s=this.I;s;)t+=s.K,s=s.I;return t}G(t){t.I=this,this.M.push(t)}J(t){this.V+=this.j*t;for(var s=this.M.length;s--;){var i=this.M[s];i.J(t),i.F||this.M.splice(s,1)}}N(t){var s=this.M.length;if(0!==s){for(t.s(),t.tr(this.B.x,this.B.y-this.K),t.rot(this.V);s--;)this.M[s].N(t);t.r()}}X(t){t.s(),t.fs("rgba(0,0,0,0.5"),t.bp(),t.ellipse(0,12+this.K,10,5,0,0,2*d),t.fill(),t.r()}},n=0,a=0;class o{constructor(t){this.time=null==t?void 0:n+t,this.setTime=t}set(t=0){this.time=n+t,this.setTime=t}unset(){this.time=void 0}isSet(){return null!=this.time}active(){return n<=this.time}elapsed(){return n>this.time}get(){return this.isSet()?n-this.time:0}p100(){return this.isSet()?((t,s=1,i=0)=>s-i?((t,s=1,i=0)=>i>t?i:t>s?s:t)((t-i)/(s-i)):0)(this.time-n,0,this.setTime):0}}var c=class extends r{constructor(t=new e){super(),this.$=new e,this.tt=new e,this.it=0,this.ht=.98,this.et=10,this.rt=100,this.nt=-1,this.at=1,this.ot=0,this.ct=0,this.ut=1/0,this.wt=-1,this._t=0,this.dt=0,this.pt=!0,this.vt=1,this.B=t}get bt(){return this.dt+this.K}G(t){t.I=this,this.M.push(t)}gt(){this.F=!1,this.kt&&this.kt.gt(),this.I=void 0}J(t){if(this.F)if(this._t+=t,0>=this.xt||this.wt&&-1!==this.wt&&this._t>=this.wt)this.gt();else{var s=this.B.D();this.tt.H(this.at),n<this.ct&&this.tt.k(100),this.$.v(this.tt).H(this.rt),this.B.v(this.$),n>this.ct&&(this.$.k(.5),this.tt.R()),this.it-=this.ht,this.K=_.max(0,this.K+this.it),1>this.K&&(this.it=0,this.j=0),this.pt&&this.Ct(s),this.yt(),super.J(t)}}N(t){super.N(t),y&&((t,s)=>{1!=s.U&&2!=s.U||(t.s(),t.ss("#fff"),t.bp(),t.mt(s.B.x,s.B.y-s.dt),t.lt(s.B.x+40*s.$.x,s.B.y-s.dt+40*s.$.y),t.stroke(),t.ss("#f0f"),t.bp(),t.mt(s.B.x,s.B.y-s.dt),t.lt(s.B.x,s.B.y-s.dt-2*s.K),t.stroke(),t.ss("#f00"),t.bp(),t.mt(s.B.x,s.B.y-s.dt),t.lt(s.B.x+s.tt.x,s.B.y-s.dt+s.tt.y),t.stroke(),t.r())})(t,this)}Et(t){return xt.St.At&&0!==xt.St.At.Pt.length&&t.x<P.x&&t.x>=0&&t.y<P.y&&t.y>=0?xt.St.At.Pt[t.y][t.x]:null}Ct(t){var s=v(t),i=v(this.B),h=this.Et(i.D().L());if(!h||!x(this,h.Dt)){var r=s.D(),n=e.g(i,s),a=n.D();a.y=0;var o=this.Et(e.v(s,a).L());o&&x(this,o.Dt)&&r.v(a);var c=n.D();c.x=0,(o=this.Et(e.v(s,c).L()))&&x(this,o.Dt)&&r.v(c),this.B=p(r),this.$.v(n.k(-1))}}yt(){var t=v(this.W()).L(),s=this.Et(t);if(s){var i=s.Tt-this.dt;0>i&&x(this,s.Dt)&&(this.K+=this.dt-s.Tt),this.dt=s.Tt,this.Ot=s,i>0&&(this.K=_.max(0,this.K-i))}}};class l{constructor(){this.Ht=0,this.Lt=0,this.zt=[],this.Rt=0,this.Mt=0,this.Bt=[],this.Kt=0,this.Vt=0,this.jt=0,this.Ft=0,this.Zt=0,this.Ut=0,this.Wt=0,this.It=0,this.qt=0,this.Yt=0,this.Gt=0,this.Jt=0,this.Nt=[],this.Qt=0,this.Xt=0,this.$t=!1,this.ts=!1,this.hs=!1,this.es=0,this.rs=0,this.ns=0,this.as=!1,this.os=[[l.cs,l.ls,l.ls],[l.cs,l.ls,l.ls],[l.cs,l.ls,l.ls],[l.cs,l.ls,l.ls],[l.cs,l.ls,l.ls],[l.cs,l.ls,l.ls],[l.cs,l.ls,l.ls],[l.cs,l.ls,l.ls],[l.cs,l.ls,l.ls],[l.cs,l.ls,l.ls],[l.cs,"#438742","#438742"]],this.us=[],this.ws=[[8,8,2,4,4,6,4,6,6,4,0,7,[1],0,0,1,5],[12,12,2,4,7,9,7,9,9,2,0,0,[2,2,2],0,1,0,5],[30,8,5,3,22,2,28,5,10,1,2,2,[8,8,8],10,2,2,10],[10,30,5,25,3,26,5,18,1,12,8,25,[4,6,10],20,3,4,15],[10,30,5,5,3,26,3,26,1,14,2,2,[5,5,5],20,3,4,15],[30,8,25,3,16,1,2,2,15,1,15,6,[5,5,10],10,3,3,20],[30,30,7,14,5,28,4,4,25,4,11,24,[10,5,5],15,5,6,25],[20,20,4,4,18,18,4,16,16,4,12,12,[20,20],15,6,8,30],[25,25,3,22,12,4,12,4,20,20,6,3,[8,10,12],20,3,5,35],[25,25,23,23,20,4,12,12,3,20,4,4,[10,20],20,3,5,40],[20,20,5,7,7,7,0,0,0,0,0,0,[0],0,1,0,0]],this.Ht=this.Lt=0,this.ws.forEach((t,s)=>{this.us.push({c:this.os[s],_s:new e(t[0],t[1]),ds:new e(t[2],t[3]),ps:new e(t[4],t[5]),vs:new e(t[6],t[7]),ms:new e(t[8],t[9]),bs:new e(t[10],t[11]),zt:t[12]||[0],Bt:t[12]||[0],Rt:t[13]||0,Kt:t[13]||0,Vt:t[14]||0,jt:t[15]||0,Mt:t[16]||0,Ft:t[16]||0,Ut:0,Zt:0,Wt:0,It:0,$t:!1})}),this.gs()}get ks(){return this.Ht}gs(){const t=this.us[this.Ht];this.Nt=t.c,this._s=t._s,this.xs=t.ds,this.ps=t.ps,this.vs=t.vs,this.ms=t.ms,this.bs=t.bs,this.Bt=t.Bt,this.Kt=t.Kt,this.Vt=t.Vt,this.jt=t.jt,this.Ft=t.Ft,this.$t=t.$t,this.Ut=t.Ut,this.Zt=t.Zt,this.Wt=t.Wt,this.It=t.It,this.ts=0==this.Ht,this.hs=this.Ht==this.us.length-1}Cs(){this.Ht>=0&&this.Ht+1<this.us.length&&(xt.St.ys(),this.Es(),this.Lt=this.Ht++)}As(){this.Ht>0&&this.Ht-1<this.us.length&&(xt.St.ys(),this.Es(),this.Lt=this.Ht--)}Es(){const t=this.us[this.Ht];t.$t=this.$t,t.Ut=this.Ut,t.Zt=this.Zt,t.Wt=this.Wt,t.It=this.It,t.Bt=this.Bt,t.Kt=this.Kt}Ss(){this.es=0+this.us.reduce((t,s)=>t+s.Rt,0),this.rs=0+this.us.reduce((t,s)=>t+s.zt.reduce((t,s)=>t+s,0),0),this.ns=0+this.us.reduce((t,s)=>t+s.Mt,0),this.Yt=0+this.us.reduce((t,s)=>t+s.Ut,0),this.qt=0+this.us.reduce((t,s)=>t+s.Zt,0),this.Gt=0+this.us.reduce((t,s)=>t+s.Wt,0),this.Jt=0+this.us.reduce((t,s)=>t+s.It,0),this.as=!0}}l.Ps="rgba(0,0,0,.5)",l.cs="rgba(0,0,0,0)",l.ls="#7A5E3C";var u=(t,s)=>{if(t==l.cs)return t;t=t.substr(1);var i=parseInt(t,16),h=_.round(2.55*s),e=(i>>16)+h,r=(i>>8&255)+h,n=(255&i)+h;return"#"+(16777216+65536*(255>e?1>e?0:e:255)+256*(255>r?1>r?0:r:255)+(255>n?1>n?0:n:255)).toString(16).slice(1)},f=class extends c{constructor(t,s,i=0,h,r){super(),this.Ds=!1,this.Ts=!0,i=_.min(200,_.max(i,0)),this.Os=h,this.Dt=r,this.Hs=new e(t,s),this.B=p(this.Hs),this.Tt=this.Ls=i}N(t){if(xt.St.zs(this.B)){var s=~~this.Tt;t.drawImage(this.Os,_.floor(this.Dt*(S.x+1)),_.floor(S.y*s+s*(s+1)/2-s),_.floor(S.x),_.floor(S.y+s),_.floor(this.B.x-S.x/2),_.floor(this.B.y-s),_.floor(S.x),_.floor(S.y+s))}super.N(t)}},w=(t,s,i,h,e,r=!1)=>{var n=S.x/2,a=S.x/2,o=.5*n+.5*a;t.s(),t.bp(),t.mt(s,i+o),t.lt(s-n,i+o-.5*n),t.lt(s-n,i+o-h-.5*n),t.lt(s,i+o-1*h),t.cp(),t.fs(u(e,-2)),t.ss(u(e,-50)),t.stroke(),t.fill(),t.bp(),t.mt(s,i+o),t.lt(s+a,i+o-.5*a),t.lt(s+a,i+o-h-.5*a),t.lt(s,i+o-1*h),t.cp(),t.fs(u(e,5)),t.ss(u(e,50)),t.stroke(),t.fill(),t.bp(),t.mt(s,i-h),t.lt(s-n,i-h+.5*n),t.lt(s-n+a,i-h+o),t.lt(s+a,i-h+.5*a),t.cp(),t.fs(u(e,-2)),t.ss(u(e,-50)),t.stroke(),t.fill(),r&&(t.fs("#000"),t.bp(),t.ellipse(s,i-h+.5*a,4,2,0,0,2*d),t.cp(),t.fill()),t.r()};const _=Math,d=_.PI;var p=t=>{var s=new e(0,0);return s.x=(t.x-t.y)*S.x/2,s.y=(t.x+t.y)*S.y/2,s},v=t=>{var s=new e;return s.x=t.x/S.x+t.y/S.y,s.y=t.y/S.y-t.x/S.x,s},m=(t=1,s=0)=>_.random()*(s-t)+t,b=()=>2*m()-1,g=(t,s)=>~~(m()*(s-t+1)+t),k=(t,s,i)=>t>=s&&i>=t,x=(t,s)=>null!=s&&(t==xt.St.Rs||0!=s&&t!=xt.St.Rs);class C{constructor(t,s,i,h){this.Ms=t||0,this.Bs=s||0,this.Ks=i||0,this.Tt=h||0,this.Vs=this.Ms+this.Ks,this.js=this.Bs+this.Tt}set(t,s,i,h){this.Ms=t,this.Bs=s,this.Ks=i||this.Ks,this.Tt=h||this.Tt,this.Vs=this.Ms+this.Ks,this.js=this.Bs+this.Tt}get mid(){return new e(this.Ms+this.Ks/2,this.Bs+this.Tt/2)}}const y=!1;var E=768,A=432;1024>innerWidth||(E=1024,A=576),1536>innerWidth||(E=1536,A=864);var S=new e(60,30),P={x:5,y:5};function D(){for(var t="#",s=0;6>s;s++)t+="0123456789ABCDEF"[_.floor(16*m())];return t}const T="rgba(50,255,50,.5)",O={Fs:["#00f"],Zs:["#E3C199","#FCDFBE","#C6936E","#9E6A3E","#5A463B"],Us:"#db0000",Ws:"#fff",Is:"#000"},H={Fs:["#545943","#531F7C"],Zs:["#246837"],Us:"#262",Ws:"#fcc",Is:"#f00"};var L=class extends c{constructor(t,s){super(t),this.qs=!1,this.Ys=s,this.pt=!0}J(t){var s=this.wt-this._t;-1!==this.wt&&s<.1*this.wt&&(this.vt=s/(.1*this.wt)),super.J(t)}},z=class extends c{constructor(t,s,i,h,e,r,n,a){super(t),this.K=s,this.it=i,this.$=h,this.Ys=e,this.Gs=r,this.wt=n,this.Js=a,this.yt()}J(t){super.J(t),this.Ys+=1*this.Gs/t}N(t){t.fs("rgba(0,0,0,0.5"),t.fr(this.B.x-this.Ys/4,this.B.y+this.Ys/4-this.dt,this.Ys/2,this.Ys/2),t.fs(this.Js),t.fr(this.B.x-this.Ys/2,this.B.y-this.Ys/2-this.bt,this.Ys,this.Ys),super.N(t)}},R=class extends c{constructor(){super(...arguments),this.Ns=new e,this.Qs=0,this.it=0,this.Xs=0,this.$s=0,this.ti=0,this.et=0,this.si=0,this.Ys=0,this.ii=0,this.hi=0,this.ei=0,this.ri=0,this.ni=0,this.Js="#fff",this.ai=0,this.oi=0,this.ci=-1,this.li=!1,this.ui=[]}J(t){if(0===this.ci)for(;this.ui.length<this.ti;)this.emit();super.J(t),this.ui=this.ui.filter(t=>t.F);var s=this.ti/this.ri;if(this.F&&s>0){var i=1/s;for(this.ai+=t;this.ui.length<this.ti&&this.ai>i;)this.emit(),this.ai-=i;this.oi+=t,-1!==this.ci&&this.ci<this.oi&&this.gt()}}emit(){var t=this.Ns.D().k(b());this.li&&(t=e.S(t,this.q()));var s=this.li?this.W():this.B.D();s.x+=t.x,s.y+=t.y;var i=(this.li?this.q():this.V)+this.$s*b(),h=this.et+this.si*b(),r=new e(_.cos(i),_.sin(i)).k(h),n=this.Ys+this.ii*b();n=0>n?0:~~n;var a=this.hi+this.ei*b();a=0>a?0:~~a;var o=this.it+this.Xs*b();o=0>o?0:~~o;var c=this.ri+this.ni*b(),l=(a-n)/c,u=new z(s,this.Qs,o,r,n,l,c,this.Js);void 0!==this.ht&&(u.ht=this.ht),this.li?(u.K=this.Y(),xt.St.fi(u)):this.G(u),this.ui.push(u)}},M=class extends L{constructor(t,s,i){super(t,s),this.wi=!1,this.Ws=O.Ws,this.Is=O.Is,this._i=1,this.di=new o(.1),this.pi=1,this.vi=!1,this.Ys=s,null!=i&&(this.Zs=i.Zs,this.mi=i.mi,this.Us=i.Us,this.Ws=i.Ws,this.Is=i.Is),this.bi=new o,this.gi=new o(1)}J(t){.005>m()&&this.bi.set(m(.2,.1)),this.gi.elapsed()&&this.gi.set(m(1.5,3)),this.di.elapsed()&&this.di.set(m(.2,.8)),super.J(t)}ki(){var t=new R;Object.assign(t,{B:new e(0,this.Ys.y/2),V:-d/4,li:!0,ht:.098,Js:this.Us,ti:400,it:0,Xs:2,Ys:2,hi:4,ei:.5,ri:1e3,ni:100,et:0,si:5,$s:2*d,ci:300,Qs:this.Ys.y}),this.G(t)}N(t,s={B:new e,r:0}){super.N(t),t.s(),t.globalAlpha=this.vt,t.tr(this.B.x+s.B.x,this.B.y+s.B.y-this.K),this.qs&&this.X(t),t.rot(s.r+this.V),t.ss("#000"),t.bp(),t.fs(this.Zs),t.fr(-this.Ys.x/2,-this.Ys.y,this.Ys.x,this.Ys.y);let i=.5+.5*_.cos(this.bi.p100()*d*2);this.wi&&(i=.2),this.pi=.3+.3*_.cos(this.gi.p100()*d*2),this.wi&&(this.pi=-.4),2==this._i?this.xi(t):this.Ci(t),t.fs(this.mi),t.bp(),t.fr(-this.Ys.x/2,-this.Ys.y,this.Ys.x,this.Ys.y/4),t.bp(),t.fr(-this.Ys.x/2,-this.Ys.y,this.Ys.x/8,18*this.Ys.y/20),this.yi(t,i),this.vi&&this.Ei(t),t.r()}Ei(t){t.s(),t.tr(3*this.Ys.x/9,-this.Ys.y),t.fs(T),t.bp(),t.rect(-this.Ys.x/3,+this.Ys.y/3,this.Ys.x/2,this.Ys.y/3),t.fill(),t.bp(),t.ss("#000"),t.lw(1),t.rect(-this.Ys.x/3,+this.Ys.y/3,this.Ys.x/2,this.Ys.y/3),t.stroke(),t.r()}Ci(t){t.fs("#000"),t.bp(),t.lw(.1),t.s(),t.tr(3*this.Ys.x/9,-this.Ys.y/8-2),this.wi&&t.rot(d),t.arc(0,0,2,.8+this.pi,d-this.pi),t.cp(),t.fill(),t.r()}xi(t){let s=.3+.3*_.cos(this.di.p100()*d*2),i=this.Ys.x/6,h=this.Ys.y/8;t.s(),t.tr(3*this.Ys.x/9,-this.Ys.y/8),t.fs("#624"),t.bp(),t.rect(-i,-h/2,2*i,h/2+h*s),t.fill(),t.ss("#ff7"),t.lw(1.5),t.setLineDash([3,.5]),t.bp(),t.mt(-h,-1),t.lt(h,-1),t.stroke(),t.bp(),t.lw(1),t.setLineDash([2,.5]),t.mt(-h,2*s),t.lt(h,2*s),t.stroke(),t.r()}yi(t,s){t.ss("#000");const i=this.Ys.y/20;t.bp(),t.fs(this.Ws),t.ellipse(this.Ys.x/2.25,-this.Ys.y+this.Ys.y/2,.8*i,2.7*i*s,0,0,2*d),t.cp(),t.fill(),t.bp(),t.fs(this.Is),t.ellipse(.5+this.Ys.x/2.25,-this.Ys.y+this.Ys.y/2,i/2*.8,i/2*2.7*s,0,0,2*d),t.cp(),t.fill(),t.bp(),t.fs(this.Ws),t.ellipse(this.Ys.x/4,-this.Ys.y+this.Ys.y/2,1.1*i,3*i*s,0,0,2*d),t.cp(),t.fill(),t.bp(),t.fs(this.Is),t.ellipse(.5+this.Ys.x/4,-this.Ys.y+this.Ys.y/2,i/2*1.1,i/2*3*s,0,0,2*d),t.cp(),t.fill()}};let B=E/4;const K="rgba(10,10,10,.6)";var V=class extends c{constructor(){super(),this.Ai=!1,this.Si=!1,this.Pi=!1,this.Di=new o(.5),this.Ti=new M(new e,new e(32,36),O),this.Ti.Zs=O.Zs[m()*O.Zs.length>>0],this.Ti.mi=D(),this.Oi=new M(new e,new e(32,36),H),this.Oi._i=2}J(t){super.J(t),this.Di.elapsed()&&this.Di.set(.5),this.Ti.J(t),this.Oi.J(t)}N(t){t.fs("rgba(100,100,100,.2)"),t.fr(0,0,E,50);const s=xt.St;s.Rs&&(t.fs("#fff"),t.fr(E/2-B/2,10,B,20),t.fs("#d11141"),t.fr(E/2-B/2,10,s.Rs.xt/s.Rs.ut*B,20),xt.Rs.Hi.isSet()&&(t.fs("#00aedb"),t.fr(E/2-B/2,35,(1-xt.Rs.Hi.p100())*B,10)));const i=s.Li;t.st("LEVEL "+i.ks+"/"+(i.us.length-1),20,30,26),t.textAlign="right";let h=E-E/4;if(t.st("💎 "+i.Zt+"/"+s.Li.Ft,h+180,30,26),t.st(this.getCrono(),E-30,30,26),xt.Rs.zi){let s=E/6,i=30;t.st("🧭",s+30,i,26)}if(xt.Rs.vi){let s=E/6+70,i=24;t.s(),t.bp(),t.fs(T),t.mt(s,i),t.arc(s,i,20,0,2*d-2*d*xt.Rs.Ri.p100()),t.lt(s,i),t.cp(),t.fill(),t.r(),t.st("🥽",s+18,i+6,26)}if(xt.Rs.Mi){let s=E/6,i=30;t.st("🔑",s+180,i,26)}if(s.Bi.length>0){let i=E/2-B/2-80,h=36;this.Ti.N(t,{B:new e(i,h),r:0}),t.textAlign="left",t.st(":"+s.Bi.length,i+20,30,26)}if(s.Ki.length>0){let i=E/2+B/2+30,h=36;this.Oi.N(t,{B:new e(i,h),r:0}),t.textAlign="left",t.st(":"+s.Ki.length,i+20,30,26)}if(this.Pi&&(t.fs(K),t.rr(E/2-E/3,2*A/12-80,2*E/3,100,30),t.ta(),t.st(this.Vi,E/2,2*A/12-40,30)),this.Ai&&(t.fs(K),t.rr(40,A/2-A/12,E-80,A/6,30),t.ta(),t.st("Press Enter to try again",E/2-20,A/2,A/12+3*_.cos(this.Di.p100()))),this.Si){t.fs(K),t.rr(E/2-3*E/4/2,40,3*E/4,400,30),t.ta(),t.st("⭐ YOU ESCAPED! 🎉",E/2-20,100,80+3*_.cos(this.Di.p100())),t.st("⏱ "+this.getCrono()+" ⏱",E/2-20,180,60+3*_.cos(this.Di.p100()));let s=40,h=200;t.ta("center"),i.es>0&&t.st("Rescued: "+(i.Yt+" of "+i.es).padStart(12," ")+((100*i.Yt/i.es).toFixed(1)+" %").padStart(12," "),E/2-20,h+1*s,30),i.ns>0&&t.st("Diamonds: "+(i.qt+" of "+i.ns).padStart(12," ")+((100*i.qt/i.ns).toFixed(1)+" %").padStart(12," "),E/2-20,h+2*s,30),i.rs>0&&t.st("kills: "+i.Gt+" zombies and "+i.Jt+" humans",E/2-20,h+4*s,30)}}msToTime(t){var s=t%1e3,i=(t=(t-s)/1e3)%60,h=(t=(t-i)/60)%60;let e="";return h>0&&(e+=h.toString().padStart(2,"0")+":"),e+=i.toString().padStart(2,"0")+"."+_.floor(s/100).toString().substring(0,1),e}getCrono(){return this.msToTime(xt.ji)}Fi(t){this.Vi=t,this.Pi=!0}Zi(){this.Vi="",this.Pi=!1}},j=class extends c{constructor(t,s={x:5,y:5}){super(),this.Pt=[],((t=P)=>{P.x=t.x,P.y=t.y})(s);for(var i=P.y;i--;){for(var h=[],e=P.x;e--;){var r;r=new f(e,i,20,t,1),this.G(r),h.push(r)}this.Pt.push(h.reverse())}this.Pt.reverse()}},F=new class{constructor(){var t=t=>s=>{switch(s.code){case"ArrowRight":case"KeyD":this.Ui=t;break;case"ArrowDown":case"KeyS":this.Wi=t;break;case"ArrowLeft":case"KeyA":this.Ii=t;break;case"ArrowUp":case"KeyW":this.qi=t;break;case"Space":this.Yi=t;break;case"NumpadEnter":case"Enter":this.Gi=t}};window.addEventListener("keydown",t(!0)),window.addEventListener("keyup",t(!1))}};class Z{constructor(t,s){this.C=80,this.Ji=576,this.Ni=new e,this.Qi=d/4,this.Xi=new C(0,0,0,0),this.$i=new e(.5,.5),this.th=!0,this.sh=.15,this.ih=0,this.hh(),this.eh=t,this.rh=s,this.nh=t/s,this.ah=!1,this.oh=100}lh(t){this.ih=t}uh(t){t.s(),this.k(t),this.fh(t)}wh(t){t.r()}k(t){t.scale(this.$i.x,this.$i.y)}fh(t){t.tr(-this.Xi.Ms,-this.Xi.Bs)}J(t){this.ih=_.max(this.ih-t,0),this._h(this.C+.05*(this.Ji-this.C))}hh(){this.Xi.set(this.Ni.x-this.Xi.Ks/2+(this.ih?6*b():0),this.Ni.y-this.Xi.Tt/2+(this.ih?6*b():0),this.C*_.tan(this.Qi),this.Xi.Ks/this.nh),this.$i.x=this.eh/this.Xi.Ks,this.$i.y=this.rh/this.Xi.Tt}_h(t){this.C=t,this.hh()}dh(t,s){var i=new e(t,s);this.th?this.Ni.g(e.g(this.Ni,i).k(this.sh)):this.Ni=i.D(),this.hh()}}class U extends r{ph(t){return this.M.filter(s=>this.vh(t,s))}vh(t,s){if(t!==s&&t.mh.Z!==s.mh.Z)return this.bh(t,s)}bh(t,s){return t.p.x<s.p.x+s.w&&t.p.x+t.w>s.p.x&&t.p.y<s.p.y+s.h&&t.p.y+t.h>s.p.y}}class W extends c{constructor(t,s,i,h,r=-1,n=!1){super(),this.w=i,this.h=h,this.mh=t,this.gh=s||new e,this.J(0),this.wt=r,n&&xt.St.kh.G(this)}J(t){super.J(t),this.p=this.mh.B.D().v(this.gh).v(new e(0,-this.mh.K))}N(t){t.s(),t.lw(1),t.ss("#f00"),t.bp(),t.rect(this.p.x,this.p.y,this.w,this.h),t.stroke(),t.r()}}var I=class{constructor(){this.xh=[]}Ch(t){return 0==this.xh.filter(s=>s.n==t).length}yh(t,s=.3){this.xh.push({n:t,t:n+s})}J(t){this.xh=this.xh.filter(t=>n<t.t)}};let q,Y,G;Y=.3,q=(t=1,s=.05,i=220,h=0,e=0,r=.1,n=0,a=1,o=0,c=0,l=0,u=0,f=0,w=0,_=0,d=0,p=0,v=1,m=0,b=0)=>{let g,k,x=Math,C=44100,y=2*x.PI,E=o*=500*y/C/C,A=i*=(1-s+2*s*x.random(s=[]))*y/C,S=0,P=0,D=0,T=1,O=0,H=0,L=0;for(c*=500*y/C**3,_*=y/C,l*=y/C,u*=C,f=C*f|0,k=(h=C*h+9)+(m*=C)+(e*=C)+(r*=C)+(p*=C)|0;k>D;s[D++]=L)++H%(100*d|0)||(L=n?n>1?n>2?n>3?x.sin((S%y)**3):x.max(x.min(x.tan(S),1),-1):1-(2*S/y%2+2)%2:1-4*x.abs(x.round(S/y)-S/y):x.sin(S),L=(f?1-b+b*x.sin(y*D/f):1)*(L>0?1:-1)*x.abs(L)**a*t*.3*(h>D?D/h:h+m>D?1-(D-h)/m*(1-v):h+m+e>D?v:k-p>D?(k-D-p)/r*v:0),L=p?L/2+(p>D?0:(k-p>D?1:(k-D)/p)*s[D-p|0]/2):L),g=(i+=o+=c)*x.cos(_*P++),S+=g-g*w*(1-1e9*(x.sin(D)+1)%2),T&&++T>u&&(i+=l,A+=l,T=0),!f||++O%f||(i=A,o=E,T=T||1);return(t=G.createBuffer(1,k,C)).getChannelData(0).set(s),(i=G.createBufferSource()).buffer=t,i.connect(G.destination),i.start(),i},G=new(window.AudioContext||webkitAudioContext);const J=()=>X(2,.4,()=>{q(.3,0,65,.08,0,.28,0,0,1.8,0,50,0,0,0,-2,0,0,.2,0,1)}),N=()=>X(10,.4,()=>{q(.03,.5,215,0,.02,.01,2,.1,90.6,0,150,0,0,0,0,0,0,3,.01,.62)});let Q=new I;function X(t,s=.3,i){Q.Ch(""+t)&&(i(),Q.yh(""+t,s))}class $ extends c{constructor(){super(),this.kh=new U,this.Eh=!1,this.Ah=!1,this.Sh=!1,this.Ph=new Z(E,A),this.Ph.C=5e3,this.Ph.Ni=p(new e(5,5))}J(t){this.Ph.J(t),F.qi?this.Rs.tt.y-=4:F.Wi&&(this.Rs.tt.y+=2),F.Ii?this.Rs.tt.x-=2:F.Ui&&(this.Rs.tt.x+=2),(xt.Dh||F.Yi)&&this.Rs.Th()&&(X(7,.4,()=>{q(.4,.2,250,.04,0,.04,0,1,1,0,0,0,0,3,0,0,0,1,0,0)}),this.Rs.Oh()),!this.Rs.Hh&&(xt.Dh||F.Yi)&&this.Rs.Lh()&&(X(1,.2,()=>{q(.1,0,493,0,0,.25,0,1.61,1,0,286,50,20,0,-.1,0,0,1.1,0,.09)}),this.Rs.it+=10,this.Rs.tt.k(1.2)),this.kh.J(t),super.J(t)}fi(t){this.G(t)}zh(){}zs(t){return k(t.x,this.Ph.Xi.Ms-100,this.Ph.Xi.Vs+100)&&k(t.y,this.Ph.Xi.Bs-100,this.Ph.Xi.js+100)}}var tt=class extends c{constructor(t,s=new e){super(s),this.Ys=new e(16,16),this.Rh="",this.Mh=!1,this.Rh=t,this.pt=!0}J(t){this.Mh||(this.kt=new W(this,new e(-this.Ys.x/2,0-this.K-this.bt),this.Ys.x,this.Ys.y,50,!0)),super.J(t)}Bh(t){if(!this.F)return;let s=xt.St.Rs;"🔑"!=this.Rh||t.Mi||(t.Mi=!0,t===s&&xt.Kh(3,t,this,1),this.gt()),1==t.U&&"💎"==this.Rh&&xt.Kh(16,t,this,0,t.Z),t===xt.St.Rs&&("🔒"==this.Rh&&t.Mi&&!xt.Li.$t?(this.Mh=!0,xt.Li.$t=!0,xt.Kh(4,t,this,.1)):"💗"==this.Rh?xt.Kh(14,t,this,.1,this.Z):"🍄"==this.Rh?(s.Vh=1,s.Hi.set(15),this.gt()):"🧭"==this.Rh?(s.zi=!0,this.gt()):"🥽"==this.Rh&&(s.vi||(s.vi=!0,s.Ri.set(60),this.gt())))}N(t,s={B:new e,r:0}){t.s(),t.tr(0,-10),t.tr(this.B.x+s.B.x,this.B.y+s.B.y),this.X(t),t.rot(s.r+this.V),t.fs("#000"),t.bp(),t.ta();let i=this.Ys.x+(this.Mh?0:5*_.abs(_.cos(2.5*n)));t.font=i+"px serif",t.ft(this.Rh,0,4),t.r()}},st=class extends tt{constructor(t=new e,s=new e(10,40)){super("",t),this.jh=100,this.Ys=s,this.Fh=s.y}Bh(t){!t.Hh&&this.F&&1==t.U&&(t.Hh=!0,t.Zh=t.Uh.Ys=this.Ys,t.Uh.Fh=this.Fh,t.Uh.jh=this.jh,t===xt.St.Rs&&xt.Kh(2,t,this,.1),this.gt())}N(t,s={B:new e,r:0}){t.s(),t.tr(0,-10),t.lw(1),t.globalAlpha=this.vt,t.tr(this.B.x+s.B.x,this.B.y+s.B.y),this.X(t),t.rot(s.r+this.V),t.lw(2),t.fs("#d8d8d8"),t.fr(0,-(this.Ys.y-18)/2-8,this.Ys.x/2,this.Fh),t.fs("#cccccc"),t.fr(this.Ys.x/2,-(this.Ys.y-18)/2-8,this.Ys.x/2,this.Fh),t.fs("#963"),t.fr(0,-(this.Ys.y-6)/2-5,this.Ys.x,5),t.fs("#333"),t.fr(this.Ys.x/4,-(this.Ys.y-6)/2-10,this.Ys.x/2,5),t.r()}},it=class{constructor(t,s,i=!0){this.Wh=0,this.Ih=0,this.qh=[],this.Yh=t,this.Gh=i,["b","h","s","lL","lR"].forEach(i=>{for(var h=s[i]||[{f:0},{f:t}],r=1;r<h.length;r++)for(var n=h[r-1],a=h[r],o=a.f-n.f,c=0;o>c;c++){var l=c/o,u=this.qh[n.f+c],f=u||{},w={};if(n.hasOwnProperty("p")){var _=n.p[0]+(a.p[0]-n.p[0])*l,d=n.p[1]+(a.p[1]-n.p[1])*l;w.B=new e(_,d)}else w.B=new e(0,0);if(n.hasOwnProperty("r")){var p=n.r+(a.r-n.r)*l;w.r=p}else w.r=0;f[i]=w,u||this.qh.push(f)}})}get Jh(){return this.qh[this.Ih]}get Nh(){return!this.Gh&&this.Ih===this.Yh-1}J(t){this.Wh+=1,this.Ih=_.floor(this.Wh),this.Ih>this.Yh-1&&(this.Ih=0,this.Wh=0)}};let ht=-d/180*120;var et={h:[{f:0,p:[0,.5]},{f:5,p:[0,0]},{f:20,p:[0,.5]}],b:[{f:0,p:[0,0]},{f:15,p:[0,.5]},{f:20,p:[0,0]}],s:[{f:0,r:ht},{f:10,r:ht-.045},{f:20,r:ht}]},rt={h:[{f:0,r:-.1,p:[3,0]},{f:3,r:-.1,p:[3,2]},{f:7,r:-.1,p:[3,0]},{f:13,r:-.1,p:[3,2]},{f:20,r:-.1,p:[3,0]}],b:[{f:0,r:.1,p:[0,0]},{f:3,r:.1,p:[0,2]},{f:7,r:.1,p:[0,0]},{f:13,r:.1,p:[0,2]},{f:20,r:.1,p:[0,0]}],s:[{f:0,r:ht-.24,p:[5,0]},{f:10,r:ht-.2,p:[3,0]},{f:20,r:ht-.24,p:[5,0]}],lL:[{f:0,r:1.4},{f:10,r:-1.4},{f:20,r:1.4}],lR:[{f:0,r:-1.4},{f:10,r:1.4},{f:20,r:-1.4}]},nt={h:[{f:0,r:-.1,p:[1,4]},{f:3,r:-.1,p:[1,5]},{f:7,r:-.1,p:[1,4]},{f:13,r:-.1,p:[1,5]},{f:16,r:-.1,p:[1,4]}],b:[{f:0,r:.1},{f:16,r:.1}],s:[{f:0,r:-d-.5,p:[0,-20]},{f:4,r:1.5-d,p:[10,0]},{f:16,r:1.6-d,p:[10,0]}],lL:[{f:0,r:0},{f:8,r:1},{f:16,r:0}],lR:[{f:0,r:0},{f:8,r:-1},{f:16,r:0}]},at={h:[{f:0,p:[4,-.5]},{f:20,p:[4,0]}],b:[{f:0,p:[0,0]},{f:20,p:[0,0]}]},ot={h:[{f:0,r:0,p:[5,0]},{f:5,r:0,p:[5,-.5]},{f:20,r:0,p:[5,0]}],b:[{f:0,r:0,p:[0,0]},{f:20,r:0,p:[0,0]}],lL:[{f:0,p:[1,0],r:.1},{f:10,p:[-1,0],r:-.1},{f:20,p:[1,0],r:.1}],lR:[{f:0,p:[-1,0],r:-.1},{f:10,p:[1,0],r:.1},{f:20,p:[-1,0],r:-.1}]},ct=class extends L{constructor(t,s){super(t,s),this.Fh=0,this.Qh=0,this.Xh=20,this.jh=100,this.Fh=s.y}Mh(t){this.Qh+=1,this.Fh=this.Ys.y-this.Ys.y/2*(this.Qh/this.Xh),this.Qh<this.Xh||setTimeout(()=>{t.Hh=!1,this.Fh=this.Ys.y,this.Qh=0},200)}J(t){}N(t,s={B:new e,r:0}){super.N(t),t.s(),t.lw(1),t.globalAlpha=this.vt,t.tr(this.B.x+s.B.x,this.B.y+s.B.y-this.bt),this.qs&&this.X(t),t.rot(s.r+this.V),t.lw(2),t.fs("#ccf"),t.fr(0,5,this.Ys.x/2,this.Fh),t.fs("#ddf"),t.fr(this.Ys.x/2,5,this.Ys.x/2,this.Fh),t.fs("#963"),t.fr(0,5,this.Ys.x,5),t.fs("#333"),t.fr(this.Ys.x/4,0,this.Ys.x/2,5),t.r()}},lt=class extends L{constructor(t,s,i){super(t,s),this.$h=new e(12,18),this.te=new e(4,12),this.se=new e(5,4),this.Zh=new e(10,40),this.ie=i,this.$h=s}J(t){super.J(t)}N(t,s={B:new e,r:0}){super.N(t);var i=this.ie.he.Jh;t.s(),t.lw(1),t.globalAlpha=this.vt,t.tr(this.B.x,this.B.y-this.K),this.qs&&this.X(t),t.rot(s.r+this.V),t.fs(this.ie.Zs),i.lL&&i.lR&&(t.s(),t.tr(-this.se.x/2-this.$h.x/3,-2),t.rot(i.lL.r),t.fr(0,this.se.y,this.se.x,this.se.y/3),t.r(),t.s(),t.tr(-this.se.x/2+this.$h.x/3,-2),t.rot(i.lR.r),t.fr(0,this.se.y,this.se.x,this.se.y/3),t.r()),t.s(),t.rot(i.b.r),t.fs(this.ie.Fs),t.fr(-this.$h.x/2+i.b.B.x,-this.$h.y+i.b.B.y,this.$h.x,this.$h.y),t.fs(this.ie.Zs),2==this.ie.U?(t.s(),t.tr(0,-this.$h.y+this.$h.y/4),t.rot(-d/2),t.fr(-this.te.x/2,0,this.te.x,1.2*this.te.y),t.r()):this.ie.Hh||(t.s(),t.tr(0,-this.$h.y+this.$h.y/4),t.rot(-20*i.b.r),t.fr(-this.te.x/2,0,this.te.x,this.te.y),t.r()),t.r(),t.r()}};class ut{static goToPosition(t,s=new e){let i=0,h=0,r=e.g(s,t.B);const n=r.T();return n>1&&(i=r.P()-t.ee,h=1),{m:h,r:i,d:n}}}class ft extends c{constructor(t=new e){super(t),this.Fs=O.Fs[m()*O.Fs.length>>0],this.Us=O.Us,this.Ws=O.Ws,this.Is=O.Is,this.re=new e(16,18),this.ne=new e(1,m(15,20)),this.$h=new e(12,18),this.se=new e(4,4),this.te=new e(4,12),this.Zh=new e(10,40),this.ae=!1,this.oe=!1,this.ce=!1,this.dt=0,this.le=4,this.Mi=!1,this.ue=0,this.Hh=!1,this.vi=!1,this.zi=!1,this.fe=new o,this.Hi=new o,this.Ri=new o,this.we="#00ff00",this.Vh=0,this.ee=d,this._e=ut.goToPosition,this.U=1,this.xt=this.ut=100,this.rt=10,this.at=1,this.ot=2,this.de=new it(20,et),this.pe=new it(20,rt),this.ve=new it(16,nt,!1),this.he=this.de,this.me()}get bt(){return this.dt+this.K}me(){this.Zs=O.Zs[m()*O.Zs.length>>0],this.mi=D(),this.be()}ge(t){let s=this._e(this,this.ke);this.xe(s.r),this.Ce(s.m*t),2>s.d&&(this.ke=null)}xe(t){this.ee+=t}Ce(t){this.tt.v(e.A(this.ee,t))}Lh(){return 0===this.K}Th(){return 0===this.K&&this.Hh}J(t){this.$.x>.2&&!this.ye?this.ye=!0:-.2>this.$.x&&this.ye&&(this.ye=!1),null==this.ke||this.fe.active()||this.ge(t),this.Ee(),this.Ae.J(t),this.Se.J(t),this.Uh.J(t),this.Pe(),this.he.J(t),this.oe=this.he==this.ve,this.oe&&!this.ce&&(this.ce=!0,setTimeout(()=>{this.ce=!1},400)),this.Hh&&this.$.k(.5),1==this.Vh&&30>this.$h.y&&this.De(1.01),2==this.Vh&&this.$h.y>10&&this.De(.99),0==this.Vh&&(this.$h.y-xt.Te.$h.y>1?this.De(.99):xt.Te.$h.y-this.$h.y>1&&this.De(1.01)),this.Hi.elapsed()&&(this.Vh=0,this.Hi.unset()),this.Ae.vi=this==xt.Rs&&this.vi,this.Ri.elapsed()&&(this.vi=!1,this.Ri.unset()),super.J(t)}De(t=1){this.$h.k(t),this.re.k(t),this.be(),this.Se.te.k(t),this.Se.se.k(t)}gt(){if(this.F){for(this.kt&&(this.kt.F=!1),this.ae&&this.Oe(),this.Hh&&this.He(new st(this.B.D(),this.Zh)),this.Mi&&this.He(new tt("🔑",this.B.D()));this.ue>0;){let t=new tt("💎",this.B.D());this.ue--,xt.St.Le.push(t),this.He(t,2,20)}super.gt()}}He(t,s=g(.5,1),i=4){this.ze(t,40,s,i),xt.St.fi(t)}Oe(){var t=new M(this.B.D(),this.re,this);t.wi=!0,t.ki(),t.Zs=this.Ae.Zs,t.Us=this.Ae.Us,t.wt=3e3,t._i=this.U;var s=new lt(this.B.D(),this.$h,this);s.te=this.te,s.se=this.se,s.wt=3e3,s.ct=n+.03,this.ze(s,this.K+1,12,20,-.25),t.ct=n+.03,this.ze(t,this.K+1,12,20,.25);let i=xt.St;i.fi(t),i.fi(s)}be(){null==this.Se&&(this.Se=new lt(new e(0,9),this.$h,this)),null==this.Ae&&(this.Ae=new M(new e(0,this.Se.B.y-this.$h.y),this.re,this)),this.Ae.Zs=this.Zs,this.Ae.mi=this.mi,this.Se.Zs=this.Zs,this.Ae.B.y=this.Se.B.y-this.$h.y,this.Ae._i=this.U,2==this.U&&(this.Ae.Zs=this.Zs,this.Ae.Ws=H.Ws,this.Ae.Is=H.Is),this.Uh=new ct(new e(1,this.Se.B.y),this.Zh),this.Ae.I=this.Se.I=this.Uh.I=this}ze(t,s,i,h,r=10){t.yt(),t.tt.v(e.A(m()*d*2).k(r)),t.K=s,t.it+=i,t.j=b()/h,t.qs=!0}Pe(){[this.ve].includes(this.he)&&!this.he.Nh||(this.$.T()>.1?this.he=this.pe:this.he=this.de)}Re(t,s=1,i=!1){const h=e.g(t.B,this.B).O().k(-100);this.tt.v(h),(t.$.T()>5||i)&&0==this.it&&(this.it+=5)}Bh(t){if(this.F&&!this.ce&&(this.Re(t,1,!1),t==xt.St.Rs&&1==t.Vh&&(this.ct=n+.1,this.Re(t,2,!0)),t==xt.St.Rs&&this.Hh&&t.$.D().T()>.5)){var s=new st(t.B.D(),this.Zh);s.Fh=t.Uh.Fh,this.He(s),this.Hh=!1,this.fe.set(3)}}Ee(){if(!this.F)return;let t=[];t.push({t:1,c:new W(this,new e(-10,-12-this.bt+this.K),20,15,50,!0)}),this.Hh&&this.oe&&t.push({t:2,c:new W(this,new e(0+(this.ye?0:-1)*(this.Uh.Fh+20),-35-this.bt+this.K),this.Uh.Fh+20,45,50,!0)}),t.forEach(t=>{xt.St.kh.ph(t.c).forEach(s=>{s.mh.Bh(this),s.mh instanceof ft&&xt.Me(this,s.mh,t.t)})})}Oh(){xt.Kh(5,this,null),this.he=this.ve,this.ve.Ih=0;var t=this.ye?1:-1,s=xt.St.kh.ph(new W(this,new e(t*(this.$h.x/2+10+(this.ye?0:36)),-30),36,20));s.length>0&&s.forEach(t=>{0===t.K&&t.mh.Bh(this,!1)})}N(t){if(xt.St.zs(e.v(this.B,new e(0,-this.bt)))){super.N(t);var s=this.he.Jh;if(t.s(),t.tr(0,-10),t.lw(1),t.tr(this.B.x,this.B.y-this.bt),this.Ot&&(t.fs("rgba(0,0,0,0.5"),t.bp(),t.ellipse(0,12+this.K,10,5,0,0,2*d),t.fill()),this.ye||t.scale(-1,1),this.Se.N(t,s.b),this.Ae.N(t,s.h),this.Hh&&this.Uh.N(t,s.s),t.ta(),t.font="bold 15px serif",this.Mi&&(t.bp(),t.ft("🔑",0,4)),this!=xt.St.Rs&&this.ue>0&&(t.bp(),t.ft("💎",0,4),y&&(this.ye||t.scale(-1,1),t.st(this.ue,0,0,20))),xt.St instanceof pt&&100==this.ut&&90>this.xt||300==this.ut&&250>this.xt){this.ye||t.scale(-1,1),t.lineWidth=2;let s=20,i=this.$h.y+this.re.y;t.bp(),t.ss("#fff"),t.mt(0-s/2,0-i),t.lt(0+s/2,0-i),t.stroke(),t.bp(),t.strokeStyle=this.Us,t.mt(0-s/2,0-i),t.lt(0-s/2+s*(this.xt/this.ut),0-i),t.stroke()}t.r()}}}var wt=class extends c{constructor(t=new e,s=new e(10,40)){super(t),this.Ys=s}N(t){t.s(),t.tr(0,-10),t.lw(1),t.globalAlpha=this.vt,t.tr(this.B.x,this.B.y-this.bt),t.rot(this.V),t.fs("#875638"),t.fr(this.Ys.x/2,-this.Ys.y,this.Ys.x,this.Ys.y),t.r()}};class _t extends ft{constructor(t=new e){super(t),this.le=1,this.U=2,this.Fs=H.Fs[m()*H.Fs.length>>0],this.Zs=H.Zs[m()*H.Zs.length>>0],this.Us=this.Ae.Us=H.Us,this.be(),this.Ae._i=2,this.Ae.Ws=H.Ws,this.Ae.Is=H.Is,this.de=new it(20,at),this.pe=new it(20,ot),this.rt=.8}}var dt=class extends c{constructor(t,s,i){super(t),this.Ys=s,this.Be=i,this.wt=250}J(t){super.J(t),this.it+=2}N(t){t.s(),t.tr(this.B.x,this.B.y),t.bp(),t.st(this.Be,0-this.Ys.x/2,0+this.Ys.y/2-this.K,12,"Helvetica"),t.r()}},pt=class extends ${constructor(t,s=new l,i=new ft){super(),this.Bi=[],this.Ki=[],this.Ke=[],this.Le=[],this.Ve=new o,this.je=!0,this.Fe=!1,this.Ze=0,this.Ue=32,this.We=[],this.Ie=[],this.qe=[],this.Ye=[],this.Ge=!1,this.Je=()=>new Promise(t=>{this.At=new j(this.Os,{x:this.Li._s.x,y:this.Li._s.y}),null!=this.At&&t("OK")}),this.Os=t,this.Li=s,this.Rs=i,this.Rs.B=new e,this.Ne=new V,this.Qe=new c,this.Je(this).then(()=>{this.gs()})}gs(){if(this.G(this.Qe),this.G(this.At),this.Li.Ht>6){let t=new tt("🍄",vt());t.K=50,this.Qe.G(t)}const t=new e(this.Li.xs.x,this.Li.xs.y);let s,i,h,r;if(s=this.Li.ps,this.Xe=this.At.Et(s),this.Xe.Dt=2,this.Xe.Tt=30,this.Xe.Ds=!0,!this.Li.hs){if(i=this.Li.vs,this.$e=this.At.Et(i),this.$e.Tt=30,this.$e.Ds=!0,!this.Li.$t){let t=new tt("🔒",this.$e.B);t.B=this.$e.B.D().v(new e(0,-15)),t.K=50,this.Qe.G(t)}if(h=this.Li.ms,this.sr=this.At.Et(h),this.sr.Tt=30,this.sr.Ds=!0,!this.Li.$t){let t=new tt("🔑",this.sr.B);t.B=this.sr.B.D().v(new e(0,-15)),t.K=50,this.Qe.G(t)}}this.ir=this.At.Et(t),this.Li.ts||this.Li.hs||(this.Li.hs||(this.ir.Tt=-500),this.ir.Ds=!0,this.ir.Dt=0,this.ir&&(this.hr=new f(this.ir.Hs.x-1.4,this.ir.Hs.y-1.3,this.ir.Tt,this.ir.Os,1),this.hr.Tt=3,this.Qe.G(this.hr))),r=this.Li.Lt>this.Li.Ht?p(new e(s.x+2.5,s.y+.5)):p(t.v(new e(1.5,-.5))),this.Rs.B=r,this.Rs.Hh=this.Li.er,this.Li.hs&&(this.Rs.Hh=!1),this.Rs.nr=!1,(this.Li.Ht<this.Li.Lt||this.Li.ts)&&(this.Rs.K=1500),this.Qe.G(this.Rs);let n=0,a=0;for(;n++<this.Li.jt;){let t=m()>.8,s=t?new st(new e,new e(12,50)):new st;if(s.B=p(this.Li.bs).v(new e(t?4:0,0)),s.K=30,s.tt.v(e._().k(10)),s.V=m(-1,1)*d/4,this.Ke.push(s),this.Qe.G(s),++a>1e3)break}for(this.ar(this.Ke,"💗",this.Li.Vt),this.ar(this.Le,"💎",this.Li.Ft-this.Li.Zt);this.Bi.length<this.Li.Kt;){let t=0;var o=vt();if(e.C(o,this.Rs.B)>this.Li._s.x*S.x/4){let t=new ft(o);t.K=20,t.$.v(new e(m(-1,1),m(-1,1)).k(m(.1,.5))),this.Bi.push(t),this.Qe.G(t)}if(++t>1e3)break}if(this.or=null,!this.Rs.zi&&(xt.cr||this.Li.Ht>2)){let t=new tt("🧭",vt());xt.cr&&(t.B=this.Rs.B.D().v(e._().k(60))),t.K=50,this.Qe.G(t)}if(xt.cr&&this.Li.Ht>=0||!xt.cr&&this.Li.Ht>2){let t=new tt("🥽",vt());xt.cr&&(t.B=this.Rs.B.D().v(e._().k(60))),t.K=50,this.Qe.G(t)}}ar(t,s="",i=0){let h=0,r=0;if(this.Rs)for(;i>r;){let i=vt(),n=t.filter(t=>50>e.C(i,t.B)).length>0,a=0==this.Ke.filter(t=>50>e.C(i,t.B)).length,o=!this.ir||e.C(i,this.ir.B)>50,c=!this.sr||e.C(i,this.sr.B)>50,l=!this.Xe||e.C(i,this.Xe.B)>50;if(!n&&a&&o&&l&&c){let h=new tt(s,i);t.push(h),this.Qe.G(h),r++}if(++h>1e3)break}}fi(t){this.Qe.G(t)}lr(t,s){this.Qe.G(new dt(t.D(),new e(4,4),s))}J(t){if(!this.Li.hs&&this.Fe&&F.Gi&&(this.Eh=!0),this.Ne.J(t),null!=this.Rs){if(this.Fe||this.Li.hs||(xt.ji+=t),0==this.Rs.xt){if(!this.Fe){let t=new _t(this.Rs.B.D());t.mi=this.Rs.mi,t.be(),t.K=20,t.$.v(e._().k(m(.1,.5))),this.Ki.push(t),this.Qe.G(t),this.Rs=t,this.Fe=!0}this.Ne.Ai=!0}if(40>this.Rs.xt&&!this.Fe&&xt.Kh(12,this.Rs,null),this.Li.ts||this.Li.hs||this.Rs.Ot!=this.ir||!this.ur(this.Rs)||this.Ah||(this.Ah=!0),0==this.Rs.K&&this.Li.Bt.length>=1&&this.Li.Bt[this.Ze]>0&&0==this.Ki.length){let t=0;for(;this.Ki.length<this.Li.Bt[this.Ze];){var s=vt();if(e.C(s,this.Rs.B)>200){let t=new _t(s);this.Li.Ht>=8&&m()>.7?(t.Vh=2,t.rt=1.8):(7==this.Li.Ht&&m()>.9||this.Li.Ht>7&&m()>.7)&&(t.Vh=1,t.xt=t.ut=300,t.rt=.4,t.le=2),t.K=20,this.Ki.push(t),this.Qe.G(t)}if(++t>1e3)break}if(this.Ze>0&&this.Li.Bt.length>1){if(this.Ne.Fi("Wave "+(this.Ze+1)+" of "+this.Li.Bt.length),setTimeout(()=>{this.Ne.Zi(),this.Ze+=1},3e3),xt.cr&&this.Li.Ht>4){let t=new tt("🍄",vt());t.K=50,this.Qe.G(t)}}else this.Ze+=1}if(this.Li.hs&&this.Ze>=this.Li.Bt.length-1&&0==this.Ki.length&&(this.Ne.Si=!0,setTimeout(()=>{this.Ge=!0},2e3),this.Ge&&this.wr(),this.qe.forEach(s=>s.J(t))),this.Li.$t){if(this.Rs.Mi=!1,!this.or&&this.Xe){let t=new f(this.Xe.Hs.x-.65,this.Xe.Hs.y-.65,this.Xe.Tt-20,this.Xe.Os,2);this.Qe.G(t),this.Xe.Dt=0,this.or=new wt(this.Xe.B.D(),new e(3,200)),this.or.K=200,xt.St.fi(this.or),this.Ve.set(.5)}this.Rs.Ot&&this.Xe&&30>e.C(this.Rs.Ot.B,this.Xe.B)&&(this.Rs.B=this.Xe.B.D().v(new e(-3,S.y/2-10)),this.Rs.$.R()),(this.ur(this.Rs)&&this.Rs.Ot&&this.Rs.Ot===this.Xe&&this.Ve.elapsed()&&!this.Rs.nr||this.Rs.nr)&&(this.Rs.nr=!0,this.Xe.Tt+=1.5),this.Rs.Ot&&this.Rs.Ot.Tt>120&&(this.Eh=!0)}this.Ki=this.Ki.filter(t=>t.F),this.Bi=this.Bi.filter(t=>t.F),this.Ke=this.Ke.filter(t=>t.F),this.Le=this.Le.filter(t=>t.F),this.Bi.forEach(t=>{if(null==t.ke){let s=vt();e.C(s,t.B)>20&&(t.ke=s)}}),this.Ki.sort(()=>m()-.5).some(t=>{t.ke=null;let s=this.Bi.filter(s=>100>e.C(t.B,s.B)).sort(s=>e.C(s.B,t.B));s.length>0?t.ke=s[0].B.D():this.Rs.F&&this.ur(this.Rs)&&(t.ke=this.Rs.B.D())}),this.Ke.forEach(t=>{null!=t._r&&(t.B,t._r.B)}),this.Qe.M=this.Qe.M.sort((t,s)=>s.B.y-t.B.y),super.J(t)}}dr(t){return 2==t.U}ur(t){return 1==t.U}pr(t){return t==xt.St.Rs}ys(){this.Li.Ut=this.Bi.length,this.Li.Bt=[this.Ki.length],this.Li.Kt=this.Bi.length,this.Li.Ft=this.Ke.filter(t=>t instanceof tt&&"💎"==t.Rh).length}Me(t,s,i){t==this.Rs&&2==i&&this.dr(s)?xt.Kh(8,t,s,.3,s.Z):2==i&&t==this.Rs&&this.ur(s)?xt.Kh(9,t,s):this.dr(t)&&this.ur(s)&&s!=this.Rs?xt.Kh(11,t,s):this.dr(t)&&s===this.Rs&&(this.Rs.ce||1==this.Rs.Vh||xt.Kh(10,t,s,.4))}vr(t,s,i){let h=xt.St.Rs;if(null==i||i.F)switch(t){case 14:h.xt<h.ut&&(X(10,.4,()=>{q(.5,.05,288,.02,.07,.15,2,.87,-4.6,0,-317,.04,0,0,0,0,0,.71,.03,0)}),h.xt=h.ut,this.lr(h.B,i.Rh),i.gt());break;case 12:J();break;case 10:xt.St.Ph.lh(20),i.xt=_.max(0,i.xt-10),i.xt>0||xt.St.Ph.lh(100),J();break;case 11:if(i.xt=_.max(0,i.xt-25),0==i.xt){let t=new _t(i.B.D());t.mi=i.mi,t.K=20,t.$.v(e._().k(m(.1,.5))),t.Hh=!1,this.Ki.push(t),this.Qe.G(t)}break;case 5:h.Uh.Mh(h);break;case 9:case 8:i.xt=_.max(0,i.xt-h.Uh.jh/i.le),i.xt>0?X(3,0,()=>{q(.5,.05,90,.02,.02,.07,4,1,0,0,0,0,0,2,50,0,0,.7,.01,0)}):(X(30,.8,()=>{q(.5,.05,120,.03,.12,.07,4,1,1,1.1,150,0,.01,2,45,0,0,.2,.04,0)}),i.ae=!0,2==i.U?xt.mr(1):xt.br(1));break;case 16:s==xt.Rs?(xt.gr(1),N()):s.ue++,i.gt();break;case 2:X(6,.4,()=>{q(.4,.2,150,.05,0,.05,0,1,-1,0,0,0,0,4,0,0,0,1,.02,0)});break;case 3:X(4,.3,()=>{q(.2,0,300,.1,.3,.1,0,1.61,0,0,286,.06,.18,0,0,0,0,.4,.1,.09)}),this.lr(i.B,i.Rh);break;case 4:X(5,.3,()=>{q(.2,0,850,.1,.3,.1,0,1.61,0,0,286,.06,.18,0,0,0,0,.4,.1,.09)}),i.Rh="🔓",this.lr(i.B,i.Rh)}}N(t){if(this.je&&(t.globalCompositeOperation="source-over"),this.Rs&&this.Ph.dh(this.Rs.B.x,this.Rs.B.y+this.Rs.K-this.Rs.bt),this.Ph.uh(t),super.N(t),this.Rs.zi){let s=this.Rs.B.D().v(new e(0,-this.Rs.bt+this.Rs.K));if(t.lw(4),this.Ki.forEach(i=>{let h=new e(i.B.x,i.B.y-i.bt),r=e.g(h,s);t.bp(),t.ss(T),t.ellipse(s.x,s.y,30,15,0,r.P()-.2,r.P()+.2),t.stroke()}),this.Xe&&this.$e&&!this.Rs.nr&&(this.$e&&this.Rs.Mi||this.Li.$t)){let i=this.Li.$t?this.Xe.W():this.$e.W(),h=e.g(i,s);t.bp(),t.lw(2),t.ss("rgba(255,255,255,.2)"),t.s(),t.tr(s.x,s.y),t.rot(h.P()),t.setLineDash([10,20]),t.mt(30,0),t.lt(0,0),t.mt(30,0),t.lt(25,3),t.mt(30,0),t.lt(25,-3),t.stroke(),t.r()}}y&&this.kh.N(t),this.Ph.wh(t);let s=xt.St.Rs;if(s&&this.je&&!this.Li.hs){let e=6+_.abs(_.cos(n/20+10*m()));s.vi&&this.Ue>4&&(this.Ue*=.98),!s.vi&&24>this.Ue&&(this.Ue*=1.02);var i=E,h=A,r=xt.kr.cloneNode().getContext("2d"),a=r.createRadialGradient(i/2,h/2,i/this.Ue+i/this.Ue*e,i/2,h/2,0);a.addColorStop(0,"transparent"),a.addColorStop(1,"white"),r.fillStyle=a,r.filter="blur(5px)",r.fr(0,0,i,h);var o=E/2,c=A/2;t.globalCompositeOperation="destination-in",t.drawImage(r.canvas,o-i/2,c-h/2),t.globalCompositeOperation="lighten",t.fr(0,0,i,h),t.globalCompositeOperation="source-over"}this.Ne.N(t)}wr(){this.Li.as||(this.Li.Es(),this.Li.Ss()),this.We.length<_.min(100,this.Li.Yt)?this.xr(this.We,new e(0,-50),O):this.Ye.length<_.min(100,this.Li.qt)?this.Cr(new e(0,120)):this.qe.length<_.min(100,this.Li.Gt)?this.yr(this.qe,new e(-150,120),H):this.Ie.length<_.min(100,this.Li.Jt)&&this.yr(this.Ie,new e(150,120),O)}xr(t,s,i){var h=new ft(this.Xe.B.D().v(s));h.wt=-1,h.yt(),h.$.v(e.A(m()*d*2).k(40*m())),h.K=20,h.it+=3,h.j=b()/2,xt.St.fi(h),this.We.push(h)}Cr(t,s){var i=new tt("💎",this.Xe.B.D().v(t));i.Mh=!0,i.wt=-1,i.yt(),i.$.v(e.A(m()*d*2).k(40*m())),i.K=20,i.it+=3,i.j=b()/2,xt.St.fi(i),this.Ye.push(i)}yr(t,s,i){var h=new M(this.Xe.B.D().v(s),new e(16,18),this);h.Ws=i.Ws,h.Is=i.Is,h.Us=i.Us,h.Zs=i.Zs[m()*i.Zs.length>>0],h.mi=D(),i.Us==H.Us&&(h._i=2,h.U=2,h.Zs=H.Zs[m()*H.Zs.length>>0]),h.wi=!0,h.ki(),h.wt=-1,h.ct=n+.03,h.yt(),h.$.v(e.A(m()*d*2).k(40*m())),h.K=20,h.it+=3,h.j=b()/2,h.qs=!0,xt.St.fi(h),t.push(h)}};function vt(){return p(new e(g(0,P.x-1),g(0,P.y-1)))}const mt="efdh_",bt=(t,s)=>{localStorage[mt+t]=s};var gt={save:bt,get(t="",s){let i=localStorage[mt+t];return null==i&&bt(t,s),i||s}},kt=class extends ${constructor(t){super(),this.Er=!1,this.Ar=-.098,this.Rs=t,this.Ne=new V,this.Ne.N=t=>{t.fs("#111"),t.rr(9,9,E-18,A/3,20),t.ta(),t.st("Escape from",E/2-9,A/8-A/18,E/20,"sans-serif","#ED1B23","#fff"),t.st("DEATH HOLE",E/2-9,A/8+A/10,E/8,"sans-serif","#ED1B23","#fff"),t.fs("#896A44"),t.fr(0,3*A/4,E/2-100,A/3),t.fr(E/2+100,3*A/4,E/2-100,A/3),t.fs("#438742"),t.fr(0,3*A/4,E/2-100,50),t.fr(E/2+100,3*A/4,E/2-100,50),this.Er||(t.fs("#444"),t.fr(E/2-100,3*A/4,200,25));let s=1*A/30;t.st("Use arrow keys or WASD to move",E/2,A/2-4*s,20),t.st("Click or Space to action",E/2,A/2-3*s,20),xt.cr?(t.st("👋 Hello Coil member!",7*E/8,A/2+2*s,18),t.st("Click on player",7*E/8,A/2+4*s,18),t.st("to change color",7*E/8,A/2+5*s,18)):(t.st("Coil members",7*E/8,A/2+3*s,18),t.st("can change",7*E/8,A/2+4*s,18),t.st("player colors",7*E/8,A/2+5*s,18),t.st("and get extra powerups",7*E/8,A/2+6*s,18)),t.st("Press Enter to start",E/2,A/2+A/2.5,40+3*_.cos(this.Ne.Di.p100()))},this.Ph.Ni=new e(24,-22),this.Ph.Ji=this.Ph.C=400,this.Rs.B=new e(-100,30),this.G(this.Rs)}J(t){super.J(t),this.Ne.J(t),this.Rs.tt=new e(30,0),this.Ph.Xi.mid.x>this.Rs.B.x?this.Ph.Ni=new e(24-100*n,-22):this.Rs.tt.R(),F.Yi&&this.Rs.Lh()&&xt.cr&&this.Sr(),F.Gi&&!this.Er&&(this.Er=!0,setTimeout(()=>{this.Eh=!0},2500)),this.Er&&(this.Ar*=1.1,this.Rs.B.y-=this.Ar)}N(t){this.Ph.uh(t),super.N(t),y&&this.kh.N(t),this.Ph.wh(t),this.Ne.N(t)}zh(){super.zh(),xt.cr&&this.Sr(),gt.save("skinColor",xt.Te.Zs),gt.save("hairColor",xt.Te.mi)}Sr(){N(),this.Rs.me(),xt.Te.mi=this.Rs.mi,xt.Te.Zs=this.Rs.Zs}},xt=new class{constructor(){this.Li=new l,this.ji=0,this.Pr=[],this.Dr=new I,this.cr=!1,this.Tr=t=>new Promise(s=>{t.Li.us.forEach(s=>{const i=(t=>{var s=document.createElement("canvas"),i=s.getContext("2d");i.imageSmoothingEnabled=!0,s.width=(S.x+1)*t.length,s.height=60*S.y+1830;for(var h=0;h<t.length;h++)for(var e=t[h],r=h*(S.x+1)+(S.x+1)/2,n=0;60>n;n++){var a=n,o=S.y*n+n*(n+1)/2;w(i,r,o,a,e,2==h)}return s})(s.c);t.Pr.push(i)}),t.Pr.length>0&&s("OK")}),this.Wh=performance.now(),this.kr=document.getElementById("game"),this.Or=this.kr.getContext("2d"),this.kr.width=E,this.kr.height=A,oncontextmenu=()=>!1,onscroll=t=>t.preventDefault();const t=t=>()=>{this.Dh=t};this.kr.addEventListener("mousedown",t(!0)),this.kr.addEventListener("mouseup",t(!1)),this.Tr(this).then(()=>{this.Hr()}),this.Te=new ft(new e(0,0)),this.Te.Fs="#f00",this.Te.Zs=gt.get("skinColor",O.Zs[m()*O.Zs.length>>0]),this.Te.mi=gt.get("hairColor",D()),this.Te.be(),this.newPlayer(),this.kr.onmouseup=()=>{this.St.zh()},document.monetization&&document.monetization.addEventListener("monetizationstart",()=>{this.cr=!0})}zh(){}gr(t){this.Li.Zt+=t}mr(t){this.Li.Wt+=t}br(t){this.Li.It+=t}Kh(t,s,i,h=.3,e=""){(0==h||this.Dr.Ch(t+e))&&(this.St instanceof pt&&this.St.vr(t,s,i),0!=h&&this.Dr.yh(t+e,h))}Me(t,s,i){t.F&&s.F&&this.St instanceof pt&&this.St.Me(t,s,i)}Hr(){this.Lr(),this.St=new kt(this.Rs),this.zr()}zr(){this.Rr=requestAnimationFrame(this.Mr.bind(this))}Lr(){cancelAnimationFrame(this.Rr)}Mr(t){this.Rr=requestAnimationFrame(this.Mr.bind(this));var s=_.max(0,t-this.Wh);this.J(s),this.Wh=t,n=(a+=1)/60}Br(){this.Lr(),this.Li.er=this.St.Rs.Hh,this.Li.Cs(),this.Kr(),this.zr()}Vr(){this.Lr(),this.Li.er=this.St.Rs.Hh,this.Li.As(),this.Kr(),this.zr()}Kr(){this.Li.gs(),this.St=new pt(this.Pr[this.Li.Ht],this.Li,this.Rs),this.St.Ah=!1,this.St.Fe=!1,this.St.Rs.Ot=null}J(t){this.St.J(t),(t=>{Q.J(t)})(t),this.Dr.J(t),this.St.Eh&&(this.St.Eh=!1,this.St instanceof kt?this.Kr():this.St instanceof pt&&(this.St.Fe?(this.Lr(),this.newPlayer(),this.Kr(),this.zr()):this.Br())),this.St.Ah&&(this.Vr(),this.St.Ah=!1),this.N()}newPlayer(){this.Rs=new ft,this.Rs.Fs=this.Te.Fs,this.Rs.Zs=this.Te.Zs,this.Rs.mi=this.Te.mi,this.Rs.be(),this.Rs.rt=10,this.Rs.at=1.3,this.Rs.ot=2}N(){var{Or:t,St:s}=this;t.clearRect(0,0,E,A),t.fs("rgba(0,0,0,1)"),t.fr(0,0,E,A),t.s(),s.N(t),t.r()}};i(2)}]);